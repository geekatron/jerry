# ORCHESTRATION.yaml
# Machine-readable orchestration state for FEAT-004 adversarial strategy workflow
# Document ID: PROJ-001-FEAT-004-ORCH-STATE
# Version: 2.0
# Last Updated: 2026-02-12T00:00:00Z
# Schema Evolution: See docs/schemas/SCHEMA_VERSIONING.md
#
# DISCLAIMER: This file was generated by the orch-planner agent (v2.1.0).
# All content should be reviewed by a human before execution.

# Schema version for evolution support (semver format)
schema_version: "2.0.0"

# =============================================================================
# WORKFLOW METADATA
# =============================================================================
workflow:
  id: "adversarial-research-20260212-001"
  name: "Adversarial Strategy Research & Skill Enhancement"
  project_id: "PROJ-001-oss-release"
  feature_id: "FEAT-004"
  epic_id: "EPIC-002"
  version: "2.0"
  created_at: "2026-02-12T00:00:00Z"
  updated_at: "2026-02-12T00:00:00Z"
  status: "ACTIVE"

  # Workflow ID configuration (WI-SAO-021)
  id_source: "auto"
  id_format: "semantic-date-seq"

  # Orchestration pattern classification
  patterns:
    - SEQUENTIAL
    - CONCURRENT
    - BARRIER_SYNC
    - HIERARCHICAL
    - ADVERSARIAL_REVIEW

  # Constraints from Jerry Constitution
  constraints:
    max_agent_nesting: 1          # P-003: Single nesting
    file_persistence: true        # P-002: All state to filesystem
    user_authority: true          # P-020: User approves gates
    no_deception: true            # P-022: Transparent reasoning
    max_concurrent_agents: 2      # Fan-out in Phase 4 only
    max_adversarial_iterations: 3 # Circuit breaker per phase
    quality_threshold: 0.92       # Minimum quality score
    checkpoint_frequency: "PHASE" # AGENT | PHASE | BARRIER

# =============================================================================
# PATH CONFIGURATION (WI-SAO-021)
# =============================================================================
paths:
  base: "orchestration/adversarial-research-20260212-001/"
  pipeline: "{base}{pipeline_alias}/{phase_id}/{agent_id}/"
  barrier: "{base}cross-pollination/{barrier_id}/"

# =============================================================================
# PIPELINE DEFINITIONS
# =============================================================================
pipelines:
  adversarial:
    id: "pipeline-adversarial"
    name: "Adversarial Strategy Research Pipeline"
    description: "Sequential pipeline with adversarial review cycles and fan-out for skill enhancement"

    short_alias: "adversarial"
    skill_source: "problem-solving"

    status: "PHASE_1_PENDING"
    current_phase: 1
    total_phases: 6  # Phase 1, 2, 3, 4A, 4B, 5
    progress_percent: 0

    phases:
      # =====================================================================
      # PHASE 1: RESEARCH (EN-301)
      # =====================================================================
      - id: 1
        name: "Research"
        enabler: "EN-301"
        path_id: "phase-1-research"
        status: "PENDING"
        started_at: null
        completed_at: null
        quality_score: null
        adversarial_iterations: 0
        agents:
          - id: "ps-researcher-001"
            name: "Strategy Researcher"
            role: "creator"
            skill_source: "problem-solving"
            agent_spec: "skills/problem-solving/agents/ps-researcher.md"
            status: "PENDING"
            artifact: "orchestration/adversarial-research-20260212-001/adversarial/phase-1-research/ps-researcher-001/ps-researcher-001-research.md"
            inputs: []
          - id: "ps-critic-001"
            name: "Research Critic"
            role: "critic"
            skill_source: "problem-solving"
            agent_spec: "skills/problem-solving/agents/ps-critic.md"
            status: "PENDING"
            adversarial_modes:
              - "Red Team"
              - "Devil's Advocate"
            artifact: "orchestration/adversarial-research-20260212-001/adversarial/phase-1-research/ps-critic-001/ps-critic-001-critique-iter-{N}.md"
            inputs:
              - "orchestration/adversarial-research-20260212-001/adversarial/phase-1-research/ps-researcher-001/ps-researcher-001-research.md"
        artifacts: []
        exit_criteria:
          - "15 adversarial strategies researched"
          - "All strategies have authoritative citations"
          - "Quality score >= 0.92"

      # =====================================================================
      # PHASE 2: ANALYSIS & SELECTION (EN-302)
      # =====================================================================
      - id: 2
        name: "Analysis & Selection"
        enabler: "EN-302"
        path_id: "phase-2-selection"
        status: "BLOCKED"
        blocked_by: "barrier-1"
        started_at: null
        completed_at: null
        quality_score: null
        adversarial_iterations: 0
        agents:
          - id: "ps-analyst-001"
            name: "Strategy Analyst"
            role: "creator"
            skill_source: "problem-solving"
            agent_spec: "skills/problem-solving/agents/ps-analyst.md"
            status: "BLOCKED"
            artifact: "orchestration/adversarial-research-20260212-001/adversarial/phase-2-selection/ps-analyst-001/ps-analyst-001-selection.md"
            inputs:
              - "orchestration/adversarial-research-20260212-001/adversarial/phase-1-research/ps-researcher-001/ps-researcher-001-research.md"
          - id: "ps-critic-002"
            name: "Selection Critic"
            role: "critic"
            skill_source: "problem-solving"
            agent_spec: "skills/problem-solving/agents/ps-critic.md"
            status: "BLOCKED"
            adversarial_modes:
              - "Steelman"
              - "Strawman"
            artifact: "orchestration/adversarial-research-20260212-001/adversarial/phase-2-selection/ps-critic-002/ps-critic-002-critique-iter-{N}.md"
            inputs:
              - "orchestration/adversarial-research-20260212-001/adversarial/phase-2-selection/ps-analyst-001/ps-analyst-001-selection.md"
        artifacts: []
        exit_criteria:
          - "Decision framework with weighted criteria defined"
          - "10 strategies selected with evidence-based rationale"
          - "Rejected strategies documented with exclusion reasons"
          - "Quality score >= 0.92"

      # =====================================================================
      # PHASE 3: SITUATIONAL MAPPING (EN-303)
      # =====================================================================
      - id: 3
        name: "Situational Mapping"
        enabler: "EN-303"
        path_id: "phase-3-mapping"
        status: "BLOCKED"
        blocked_by: "barrier-2"
        started_at: null
        completed_at: null
        quality_score: null
        adversarial_iterations: 0
        agents:
          - id: "ps-architect-001"
            name: "Mapping Architect"
            role: "creator"
            skill_source: "problem-solving"
            agent_spec: "skills/problem-solving/agents/ps-architect.md"
            status: "BLOCKED"
            artifact: "orchestration/adversarial-research-20260212-001/adversarial/phase-3-mapping/ps-architect-001/ps-architect-001-mapping.md"
            inputs:
              - "orchestration/adversarial-research-20260212-001/adversarial/phase-2-selection/ps-analyst-001/ps-analyst-001-selection.md"
          - id: "ps-critic-003"
            name: "Mapping Critic"
            role: "critic"
            skill_source: "problem-solving"
            agent_spec: "skills/problem-solving/agents/ps-critic.md"
            status: "BLOCKED"
            adversarial_modes:
              - "Blue Team"
            artifact: "orchestration/adversarial-research-20260212-001/adversarial/phase-3-mapping/ps-critic-003/ps-critic-003-critique-iter-{N}.md"
            inputs:
              - "orchestration/adversarial-research-20260212-001/adversarial/phase-3-mapping/ps-architect-001/ps-architect-001-mapping.md"
        artifacts: []
        exit_criteria:
          - "All 10 strategies have applicability mapping"
          - "Strategy selection decision tree/matrix created"
          - "Edge cases and contraindications documented"
          - "Quality score >= 0.92"

      # =====================================================================
      # PHASE 4A: PS ENHANCEMENT (EN-304) - FAN-OUT ARM A
      # =====================================================================
      - id: "4A"
        name: "PS Enhancement"
        enabler: "EN-304"
        path_id: "phase-4-enhancement"
        execution_mode: "PARALLEL"  # Fan-out with Phase 4B
        fan_out_group: "phase-4"
        status: "BLOCKED"
        blocked_by: "barrier-3"
        started_at: null
        completed_at: null
        quality_score: null
        adversarial_iterations: 0
        agents:
          - id: "ps-architect-002"
            name: "PS Skill Enhancer"
            role: "creator"
            skill_source: "problem-solving"
            agent_spec: "skills/problem-solving/agents/ps-architect.md"
            status: "BLOCKED"
            artifact: "orchestration/adversarial-research-20260212-001/adversarial/phase-4-enhancement/ps-architect-002/ps-architect-002-ps-enhancement.md"
            inputs:
              - "orchestration/adversarial-research-20260212-001/adversarial/phase-3-mapping/ps-architect-001/ps-architect-001-mapping.md"
              - "skills/problem-solving/SKILL.md"
              - "skills/problem-solving/PLAYBOOK.md"
              - "skills/problem-solving/agents/ps-critic.md"
          - id: "ps-critic-004"
            name: "PS Enhancement Critic"
            role: "critic"
            skill_source: "problem-solving"
            agent_spec: "skills/problem-solving/agents/ps-critic.md"
            status: "BLOCKED"
            adversarial_modes:
              - "Red Team"
              - "Blue Team"
            artifact: "orchestration/adversarial-research-20260212-001/adversarial/phase-4-enhancement/ps-critic-004/ps-critic-004-critique-iter-{N}.md"
            inputs:
              - "orchestration/adversarial-research-20260212-001/adversarial/phase-4-enhancement/ps-architect-002/ps-architect-002-ps-enhancement.md"
        artifacts: []
        exit_criteria:
          - "ps-critic agent spec updated with adversarial modes"
          - "SKILL.md and PLAYBOOK.md updated"
          - "Invocation protocol defined"
          - "P-003 compliance verified"
          - "Quality score >= 0.92"

      # =====================================================================
      # PHASE 4B: NSE ENHANCEMENT (EN-305) - FAN-OUT ARM B
      # =====================================================================
      - id: "4B"
        name: "NSE Enhancement"
        enabler: "EN-305"
        path_id: "phase-4-enhancement"
        execution_mode: "PARALLEL"  # Fan-out with Phase 4A
        fan_out_group: "phase-4"
        status: "BLOCKED"
        blocked_by: "barrier-3"
        started_at: null
        completed_at: null
        quality_score: null
        adversarial_iterations: 0
        agents:
          - id: "nse-architect-001"
            name: "NSE Skill Enhancer"
            role: "creator"
            skill_source: "nasa-se"
            agent_spec: "skills/nasa-se/agents/nse-architecture.md"
            status: "BLOCKED"
            artifact: "orchestration/adversarial-research-20260212-001/adversarial/phase-4-enhancement/nse-architect-001/nse-architect-001-nse-enhancement.md"
            inputs:
              - "orchestration/adversarial-research-20260212-001/adversarial/phase-3-mapping/ps-architect-001/ps-architect-001-mapping.md"
              - "skills/nasa-se/SKILL.md"
              - "skills/nasa-se/PLAYBOOK.md"
              - "skills/nasa-se/agents/nse-verification.md"
              - "skills/nasa-se/agents/nse-qa.md"
          - id: "ps-critic-005"
            name: "NSE Enhancement Critic"
            role: "critic"
            skill_source: "problem-solving"
            agent_spec: "skills/problem-solving/agents/ps-critic.md"
            status: "BLOCKED"
            adversarial_modes:
              - "Devil's Advocate"
              - "Steelman"
            artifact: "orchestration/adversarial-research-20260212-001/adversarial/phase-4-enhancement/ps-critic-005/ps-critic-005-critique-iter-{N}.md"
            inputs:
              - "orchestration/adversarial-research-20260212-001/adversarial/phase-4-enhancement/nse-architect-001/nse-architect-001-nse-enhancement.md"
        artifacts: []
        exit_criteria:
          - "NASA-SE verification agents updated with adversarial modes"
          - "V&V integration documented"
          - "SE lifecycle mapping to review types"
          - "P-003 compliance verified"
          - "Quality score >= 0.92"

      # =====================================================================
      # PHASE 5: VALIDATION (EN-306)
      # =====================================================================
      - id: 5
        name: "Validation"
        enabler: "EN-306"
        path_id: "phase-5-validation"
        status: "BLOCKED"
        blocked_by: "barrier-4"
        started_at: null
        completed_at: null
        quality_score: null
        adversarial_iterations: 0
        agents:
          - id: "ps-validator-001"
            name: "Integration Validator"
            role: "creator"
            skill_source: "problem-solving"
            agent_spec: "skills/problem-solving/agents/ps-validator.md"
            status: "BLOCKED"
            artifact: "orchestration/adversarial-research-20260212-001/adversarial/phase-5-validation/ps-validator-001/ps-validator-001-validation.md"
            inputs:
              - "orchestration/adversarial-research-20260212-001/adversarial/phase-4-enhancement/ps-architect-002/ps-architect-002-ps-enhancement.md"
              - "orchestration/adversarial-research-20260212-001/adversarial/phase-4-enhancement/nse-architect-001/nse-architect-001-nse-enhancement.md"
              - "orchestration/adversarial-research-20260212-001/adversarial/phase-3-mapping/ps-architect-001/ps-architect-001-mapping.md"
              - "orchestration/adversarial-research-20260212-001/adversarial/phase-1-research/ps-researcher-001/ps-researcher-001-research.md"
          - id: "nse-qa-001"
            name: "QA Auditor"
            role: "critic"
            skill_source: "nasa-se"
            agent_spec: "skills/nasa-se/agents/nse-qa.md"
            status: "BLOCKED"
            adversarial_modes:
              - "QA Audit"
            artifact: "orchestration/adversarial-research-20260212-001/adversarial/phase-5-validation/nse-qa-001/nse-qa-001-audit.md"
            inputs:
              - "orchestration/adversarial-research-20260212-001/adversarial/phase-5-validation/ps-validator-001/ps-validator-001-validation.md"
        artifacts: []
        exit_criteria:
          - "Integration tests pass for adversarial strategy invocation"
          - "All acceptance criteria AC-1..AC-8 verified"
          - "All non-functional criteria NFC-1..NFC-4 verified"
          - "Cross-platform compatibility verified"
          - "Quality score >= 0.92"

# =============================================================================
# SYNC BARRIERS
# =============================================================================
barriers:
  - id: "barrier-1"
    name: "Research Complete"
    status: "PENDING"
    completed_at: null
    depends_on:
      - "adversarial.phase.1"
    gate_criteria:
      - "15 strategies researched with citations"
      - "Quality score >= 0.92"
    artifacts: {}

  - id: "barrier-2"
    name: "Selection Complete"
    status: "PENDING"
    completed_at: null
    depends_on:
      - "adversarial.phase.2"
    gate_criteria:
      - "10 strategies selected with decision rationale"
      - "Quality score >= 0.92"
    artifacts: {}

  - id: "barrier-3"
    name: "Mapping Complete"
    status: "PENDING"
    completed_at: null
    depends_on:
      - "adversarial.phase.3"
    gate_criteria:
      - "All 10 strategies mapped with applicability"
      - "Decision tree/matrix validated"
      - "Quality score >= 0.92"
    artifacts: {}

  - id: "barrier-4"
    name: "Enhancement Complete (Fan-In)"
    status: "PENDING"
    completed_at: null
    depends_on:
      - "adversarial.phase.4A"
      - "adversarial.phase.4B"
    gate_criteria:
      - "PS skill enhancement quality >= 0.92"
      - "NSE skill enhancement quality >= 0.92"
      - "Both fan-out arms complete"
    artifacts: {}

# =============================================================================
# EXECUTION QUEUE
# =============================================================================
execution_queue:
  current_group: 1
  groups:
    - id: 1
      name: "Phase 1: Research Agents"
      execution_mode: "SEQUENTIAL"  # creator then critic
      status: "READY"
      agents:
        - "ps-researcher-001"
        - "ps-critic-001"

    - id: 2
      name: "Barrier 1: Research Gate"
      execution_mode: "SEQUENTIAL"
      status: "BLOCKED"
      blocked_by: "group-1"
      tasks:
        - "validate-barrier-1-criteria"

    - id: 3
      name: "Phase 2: Analysis Agents"
      execution_mode: "SEQUENTIAL"
      status: "BLOCKED"
      blocked_by: "group-2"
      agents:
        - "ps-analyst-001"
        - "ps-critic-002"

    - id: 4
      name: "Barrier 2: Selection Gate"
      execution_mode: "SEQUENTIAL"
      status: "BLOCKED"
      blocked_by: "group-3"
      tasks:
        - "validate-barrier-2-criteria"

    - id: 5
      name: "Phase 3: Mapping Agents"
      execution_mode: "SEQUENTIAL"
      status: "BLOCKED"
      blocked_by: "group-4"
      agents:
        - "ps-architect-001"
        - "ps-critic-003"

    - id: 6
      name: "Barrier 3: Mapping Gate"
      execution_mode: "SEQUENTIAL"
      status: "BLOCKED"
      blocked_by: "group-5"
      tasks:
        - "validate-barrier-3-criteria"

    - id: 7
      name: "Phase 4: Enhancement Agents (Fan-Out)"
      execution_mode: "PARALLEL"
      status: "BLOCKED"
      blocked_by: "group-6"
      agents:
        - "ps-architect-002"   # Fan-out Arm A
        - "ps-critic-004"
        - "nse-architect-001"  # Fan-out Arm B
        - "ps-critic-005"

    - id: 8
      name: "Barrier 4: Enhancement Gate (Fan-In)"
      execution_mode: "SEQUENTIAL"
      status: "BLOCKED"
      blocked_by: "group-7"
      tasks:
        - "validate-barrier-4-criteria"

    - id: 9
      name: "Phase 5: Validation Agents"
      execution_mode: "SEQUENTIAL"
      status: "BLOCKED"
      blocked_by: "group-8"
      agents:
        - "ps-validator-001"
        - "nse-qa-001"

# =============================================================================
# ADVERSARIAL REVIEW STATE
# =============================================================================
adversarial_review:
  quality_threshold: 0.92
  max_iterations: 3
  escalation_policy: "USER"  # Escalate to user after max iterations

  phase_reviews:
    phase-1:
      creator: "ps-researcher-001"
      critic: "ps-critic-001"
      modes: ["Red Team", "Devil's Advocate"]
      current_iteration: 0
      quality_scores: []
      status: "PENDING"

    phase-2:
      creator: "ps-analyst-001"
      critic: "ps-critic-002"
      modes: ["Steelman", "Strawman"]
      current_iteration: 0
      quality_scores: []
      status: "PENDING"

    phase-3:
      creator: "ps-architect-001"
      critic: "ps-critic-003"
      modes: ["Blue Team"]
      current_iteration: 0
      quality_scores: []
      status: "PENDING"

    phase-4A:
      creator: "ps-architect-002"
      critic: "ps-critic-004"
      modes: ["Red Team", "Blue Team"]
      current_iteration: 0
      quality_scores: []
      status: "PENDING"

    phase-4B:
      creator: "nse-architect-001"
      critic: "ps-critic-005"
      modes: ["Devil's Advocate", "Steelman"]
      current_iteration: 0
      quality_scores: []
      status: "PENDING"

    phase-5:
      creator: "ps-validator-001"
      critic: "nse-qa-001"
      modes: ["QA Audit"]
      current_iteration: 0
      quality_scores: []
      status: "PENDING"

# =============================================================================
# CHECKPOINTS
# =============================================================================
checkpoints:
  latest_id: null
  entries: []

# =============================================================================
# METRICS
# =============================================================================
metrics:
  execution:
    phases_complete: 0
    phases_total: 6           # Phases 1, 2, 3, 4A, 4B, 5
    phases_percent: 0
    barriers_complete: 0
    barriers_total: 4
    barriers_percent: 0
    agents_executed: 0
    agents_total: 12          # 6 creators + 6 critics
    agents_percent: 0
    artifacts_created: 0
    artifacts_total: 12       # 6 creator outputs + 6 critic reviews (minimum)
    artifacts_percent: 0

  quality:
    average_quality_score: null
    min_quality_score: null
    max_quality_score: null
    total_adversarial_iterations: 0
    escalations_to_user: 0
    agent_success_rate: 0
    barrier_validation_pass_rate: 0
    checkpoint_recovery_tested: false

  timing:
    workflow_started: null
    last_activity: null
    estimated_completion: null

# =============================================================================
# ENABLER TRACKING
# =============================================================================
enablers:
  - id: "EN-301"
    title: "Deep Research: 15 Adversarial Strategies"
    phase: 1
    priority: "critical"
    effort: 13
    status: "pending"
    depends_on: []

  - id: "EN-302"
    title: "Strategy Selection & Decision Framework"
    phase: 2
    priority: "critical"
    effort: 8
    status: "pending"
    depends_on: ["EN-301"]

  - id: "EN-303"
    title: "Situational Applicability Mapping"
    phase: 3
    priority: "high"
    effort: 5
    status: "pending"
    depends_on: ["EN-302"]

  - id: "EN-304"
    title: "/problem-solving Skill Enhancement"
    phase: "4A"
    priority: "critical"
    effort: 10
    status: "pending"
    depends_on: ["EN-303"]

  - id: "EN-305"
    title: "/nasa-se Skill Enhancement"
    phase: "4B"
    priority: "high"
    effort: 8
    status: "pending"
    depends_on: ["EN-303"]

  - id: "EN-306"
    title: "Integration Testing & Validation"
    phase: 5
    priority: "high"
    effort: 5
    status: "pending"
    depends_on: ["EN-304", "EN-305"]

# =============================================================================
# BLOCKERS AND ISSUES
# =============================================================================
blockers:
  active: []

issues:
  resolved: []

# =============================================================================
# NEXT ACTIONS
# =============================================================================
next_actions:
  immediate:
    - action: "Execute Phase 1: Invoke ps-researcher-001 to research 15 adversarial strategies"
      agents: ["ps-researcher-001"]
      execution_mode: "SEQUENTIAL"

  subsequent:
    - action: "Review Phase 1: Invoke ps-critic-001 with Red Team + Devil's Advocate"
      depends_on: "ps-researcher-001 complete"
    - action: "Iterate Phase 1 if quality < 0.92 (max 3 iterations)"
      depends_on: "ps-critic-001 review"
    - action: "Pass barrier-1 and proceed to Phase 2"
      depends_on: "Phase 1 quality >= 0.92"

# =============================================================================
# RESUMPTION CONTEXT
# =============================================================================
resumption:
  last_checkpoint: null
  current_state: "Workflow not started. All phases pending."
  next_step: "Execute Phase 1: ps-researcher-001 researches 15 adversarial strategies"

  files_to_read:
    - "ORCHESTRATION_PLAN.md"
    - "ORCHESTRATION.yaml"

  cross_session_portable: true
  ephemeral_references: false
