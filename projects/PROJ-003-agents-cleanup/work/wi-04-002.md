# WI-04-002: Add PreToolUse Hook for Write/Edit Validation

| Metadata | Value |
|----------|-------|
| **ID** | wi-04-002 |
| **Phase** | 4 - Hook System |
| **Status** | PENDING |
| **Priority** | MEDIUM |
| **Created** | 2026-01-12 |

---

## Summary

Add PreToolUse hook configuration for Write/Edit operations to enable quality assurance and security validation before file modifications.

---

## Tasks

- [ ] Add PreToolUse hook section to hooks.json
- [ ] Configure matcher for "Write|Edit" operations
- [ ] Point command to pre_tool_use.py script
- [ ] Set appropriate timeout (5000ms)
- [ ] Create stub pre_tool_use.py script if needed
- [ ] Test hook fires on Write/Edit operations

---

## Acceptance Criteria

- [ ] hooks.json contains PreToolUse section
- [ ] Matcher correctly identifies Write and Edit operations
- [ ] Hook script path uses `${CLAUDE_PLUGIN_ROOT}`
- [ ] Timeout configured appropriately
- [ ] Hook fires on Write operations
- [ ] Hook fires on Edit operations

---

## Verification Evidence

### Expected hooks.json Addition
```json
{
  "PreToolUse": [
    {
      "matcher": "Write|Edit",
      "hooks": [
        {
          "type": "command",
          "command": "python3 ${CLAUDE_PLUGIN_ROOT}/scripts/pre_tool_use.py",
          "timeout": 5000
        }
      ]
    }
  ]
}
```

### Validation Commands
```bash
# PreToolUse hook exists
grep -q '"PreToolUse"' hooks/hooks.json && echo "PreToolUse: OK"

# Matcher configured
grep -q '"Write|Edit"' hooks/hooks.json && echo "Matcher: OK"
```

### Output Artifact
- **File**: `hooks/hooks.json` (modified)
- **File**: `scripts/pre_tool_use.py` (if created)

### Source Reference
- proj-003-e-001: Hook lifecycle patterns
- ADR-PROJ003-001: PreToolUse validation requirement

---

## Relationships

| Type | ID | Description |
|------|----|-------------|
| depends_on | wi-04-001 | Portable paths must be configured |
| parallel | wi-04-003 | Can proceed in parallel |
| blocks | wi-04-004 | Cleanup requires hooks configured |

---

## Notes

PreToolUse hooks can approve, reject, or modify tool invocations. Initial implementation may be a pass-through that logs operations.
