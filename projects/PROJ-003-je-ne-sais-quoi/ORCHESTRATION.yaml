# ORCHESTRATION.yaml
# Machine-readable orchestration state for EPIC-001 Je Ne Sais Quoi
# Document ID: PROJ-003-ORCH-STATE
# Version: 2.0
# Last Updated: 2026-02-19T00:00:00Z
# Generated by: orch-planner v2.1.0
# Disclaimer: This is the SSOT for workflow execution state. ORCHESTRATION_PLAN.md
#             contains strategic context. Load this file first at session resumption.

schema_version: "2.0.0"

# =============================================================================
# WORKFLOW METADATA
# =============================================================================
workflow:
  id: "jnsq-20260219-001"
  name: "EPIC-001 Je Ne Sais Quoi"
  project_id: "PROJ-003-je-ne-sais-quoi"
  epic_id: "EPIC-001"
  version: "2.0"
  created_at: "2026-02-19T00:00:00Z"
  updated_at: "2026-02-19T00:00:00Z"
  status: "ACTIVE"  # ACTIVE | PAUSED | COMPLETE | FAILED | CANCELLED

  id_source: "auto"
  id_format: "semantic-date-seq"
  # Format: {purpose}-{YYYYMMDD}-{NNN}
  # Resolved: jnsq-20260219-001

  patterns:
    - SEQUENTIAL      # Three phases execute in strict dependency order
    - CONCURRENT      # Fan-out within Phase 2 and Phase 3
    - BARRIER_SYNC    # Quality gate barriers between phases
    - HIERARCHICAL    # Orchestrator delegates to worker agents

  constraints:
    max_agent_nesting: 1          # P-003 / H-01: Single nesting level only
    file_persistence: true        # P-002: All state to filesystem
    user_authority: true          # P-020 / H-02: User approves escalations
    max_concurrent_agents: 3      # Fan-out phases: max 3 parallel streams
    max_barrier_retries: 2        # Circuit breaker: 2 extra cycles beyond min 3 (H-14)
    checkpoint_frequency: "PHASE_AND_BARRIER"
    quality_threshold_c2plus: 0.92  # H-13
    min_critic_iterations_c2plus: 3  # H-14

# =============================================================================
# PATH CONFIGURATION
# =============================================================================
paths:
  base: "orchestration/jnsq-20260219-001/"
  pipeline: "{base}{pipeline_alias}/{phase_id}/{agent_id}/"
  synthesis: "{base}synthesis/"
  # No cross-pollination path: single-pipeline workflow

  # Resolved examples:
  # Phase 1 agent:    orchestration/jnsq-20260219-001/jnsq/phase-1-persona-distillation/ps-researcher-001/
  # Phase 2 feature:  orchestration/jnsq-20260219-001/jnsq/phase-2-tier1-fanout/feat-002/ps-creator-002/
  # Synthesis:        orchestration/jnsq-20260219-001/synthesis/

# =============================================================================
# PIPELINE DEFINITION (Single pipeline: jnsq)
# =============================================================================
pipelines:
  jnsq:
    id: "pipeline-jnsq"
    name: "Je Ne Sais Quoi"
    description: >
      Single pipeline executing EPIC-001 features across 3 dependency tiers.
      Phase 1 (Tier 0) is sequential. Phases 2 and 3 are fan-out with
      quality gate barriers between each phase.

    short_alias: "jnsq"
    skill_sources:
      - "problem-solving"
      - "architecture"
      - "adversary"
      - "nasa-se"

    status: "PHASE_1_IN_PROGRESS"
    current_phase: 1
    total_phases: 3
    progress_percent: 0

    phases:
      # -------------------------------------------------------------------
      # PHASE 1: PERSONA DISTILLATION (Tier 0 — Root)
      # -------------------------------------------------------------------
      - id: 1
        name: "Persona Distillation"
        path_id: "phase-1-persona-distillation"
        feature_id: "FEAT-001"
        criticality: "C2"
        execution_mode: "SEQUENTIAL"
        status: "IN_PROGRESS"   # PENDING | IN_PROGRESS | COMPLETE | BLOCKED
        started_at: "2026-02-19T00:00:00Z"
        completed_at: null

        agents:
          - id: "ps-researcher-001"
            name: "Researcher"
            role: "Research soul of Saucer Boy; load brand signals, Jerry docs, prior persona work"
            status: "COMPLETE"
            artifact: "orchestration/jnsq-20260219-001/jnsq/phase-1-persona-distillation/ps-researcher-001/ps-researcher-001-research.md"
            inputs:
              - "projects/PROJ-003-je-ne-sais-quoi/work/EPIC-001-je-ne-sais-quoi/EPIC-001-je-ne-sais-quoi.md"
              - "docs/knowledge/"
            started_at: null
            completed_at: null

          - id: "ps-creator-001"
            name: "Creator"
            role: "Draft FEAT-001 Saucer Boy persona document (first pass)"
            status: "COMPLETE"
            artifact: "orchestration/jnsq-20260219-001/jnsq/phase-1-persona-distillation/ps-creator-001/ps-creator-001-draft.md"
            inputs:
              - "orchestration/jnsq-20260219-001/jnsq/phase-1-persona-distillation/ps-researcher-001/ps-researcher-001-research.md"
            started_at: null
            completed_at: null

          - id: "ps-critic-001"
            name: "Critic"
            role: "Creator-critic-revision loop (min 3 iterations). Apply C2 strategy sequence: S-010 → S-003 → S-002 → S-007"
            status: "COMPLETE"
            strategy_sequence: ["S-010", "S-003", "S-002", "S-007"]  # H-16: S-003 before S-002
            min_iterations: 3
            iterations_complete: 0
            artifacts:
              - "orchestration/jnsq-20260219-001/jnsq/phase-1-persona-distillation/ps-critic-001/ps-critic-001-review-r1.md"
              - "orchestration/jnsq-20260219-001/jnsq/phase-1-persona-distillation/ps-critic-001/ps-critic-001-review-r2.md"
              - "orchestration/jnsq-20260219-001/jnsq/phase-1-persona-distillation/ps-critic-001/ps-critic-001-review-r3.md"
            inputs:
              - "orchestration/jnsq-20260219-001/jnsq/phase-1-persona-distillation/ps-creator-001/ps-creator-001-draft.md"
            started_at: null
            completed_at: null

          - id: "adv-scorer-001"
            name: "Quality Scorer"
            role: "Apply S-014 LLM-as-Judge. Score 6 dimensions. Produce composite score for Barrier 1 gate."
            status: "COMPLETE"
            strategy: "S-014"
            artifact: "orchestration/jnsq-20260219-001/jnsq/phase-1-persona-distillation/adv-scorer-001/adv-scorer-001-quality-score.md"
            inputs:
              - "orchestration/jnsq-20260219-001/jnsq/phase-1-persona-distillation/ps-critic-001/ps-critic-001-review-r3.md"
            started_at: null
            completed_at: null

        quality_score: 0.925  # S-014 independent score (adv-scorer-001)

      # -------------------------------------------------------------------
      # PHASE 2: TIER 1 FAN-OUT (FEAT-002 + FEAT-003 + FEAT-005)
      # -------------------------------------------------------------------
      - id: 2
        name: "Tier 1 Fan-Out"
        path_id: "phase-2-tier1-fanout"
        feature_ids: ["FEAT-002", "FEAT-003", "FEAT-005"]
        execution_mode: "CONCURRENT"  # Three streams run in parallel
        status: "BLOCKED"
        blocked_by: "barrier-1"
        started_at: null
        completed_at: null

        streams:
          # ---- FEAT-002: /saucer-boy Skill (C3 — Critical Path) ----
          - stream_id: "feat-002"
            feature_id: "FEAT-002"
            criticality: "C3"
            critical_path: true  # Gates Barrier 2
            status: "BLOCKED"

            agents:
              - id: "ps-researcher-002"
                name: "Researcher"
                role: "Audit existing skill architecture; identify integration points for /saucer-boy skill"
                status: "BLOCKED"
                artifact: "orchestration/jnsq-20260219-001/jnsq/phase-2-tier1-fanout/feat-002/ps-researcher-002/ps-researcher-002-research.md"
                inputs:
                  - "orchestration/jnsq-20260219-001/jnsq/phase-1-persona-distillation/ps-creator-001/ps-creator-001-draft.md"
                  - "skills/"
                started_at: null
                completed_at: null

              - id: "ps-creator-002"
                name: "Creator"
                role: "Draft /saucer-boy skill structure: SKILL.md, agent definitions, templates"
                status: "BLOCKED"
                artifact: "orchestration/jnsq-20260219-001/jnsq/phase-2-tier1-fanout/feat-002/ps-creator-002/ps-creator-002-draft.md"
                inputs:
                  - "orchestration/jnsq-20260219-001/jnsq/phase-2-tier1-fanout/feat-002/ps-researcher-002/ps-researcher-002-research.md"
                started_at: null
                completed_at: null

              - id: "ps-critic-002"
                name: "Critic"
                role: "Creator-critic-revision loop (min 3 iterations). C3 strategy sequence: S-010 → S-003 → S-002 → S-007 → S-004 → S-012 → S-013. Optional: S-001, S-011."
                status: "BLOCKED"
                strategy_sequence: ["S-010", "S-003", "S-002", "S-007", "S-004", "S-012", "S-013"]
                optional_strategies: ["S-001", "S-011"]
                min_iterations: 3
                iterations_complete: 0
                artifacts:
                  - "orchestration/jnsq-20260219-001/jnsq/phase-2-tier1-fanout/feat-002/ps-critic-002/ps-critic-002-review-r1.md"
                  - "orchestration/jnsq-20260219-001/jnsq/phase-2-tier1-fanout/feat-002/ps-critic-002/ps-critic-002-review-r2.md"
                  - "orchestration/jnsq-20260219-001/jnsq/phase-2-tier1-fanout/feat-002/ps-critic-002/ps-critic-002-review-r3.md"
                inputs:
                  - "orchestration/jnsq-20260219-001/jnsq/phase-2-tier1-fanout/feat-002/ps-creator-002/ps-creator-002-draft.md"
                started_at: null
                completed_at: null

              - id: "adv-scorer-002"
                name: "Quality Scorer"
                role: "Apply S-014. Score FEAT-002. This score gates Barrier 2 (critical path)."
                status: "BLOCKED"
                strategy: "S-014"
                artifact: "orchestration/jnsq-20260219-001/jnsq/phase-2-tier1-fanout/feat-002/adv-scorer-002/adv-scorer-002-quality-score.md"
                inputs:
                  - "orchestration/jnsq-20260219-001/jnsq/phase-2-tier1-fanout/feat-002/ps-critic-002/ps-critic-002-review-r3.md"
                started_at: null
                completed_at: null

            quality_score: null

          # ---- FEAT-003: Visual Identity (C1 — Leaf) ----
          - stream_id: "feat-003"
            feature_id: "FEAT-003"
            criticality: "C1"
            critical_path: false
            status: "BLOCKED"

            agents:
              - id: "ps-creator-003"
                name: "Creator"
                role: "Draft visual identity: ASCII art, color palette, logo concepts, visual vocabulary"
                status: "BLOCKED"
                artifact: "orchestration/jnsq-20260219-001/jnsq/phase-2-tier1-fanout/feat-003/ps-creator-003/ps-creator-003-draft.md"
                inputs:
                  - "orchestration/jnsq-20260219-001/jnsq/phase-1-persona-distillation/ps-creator-001/ps-creator-001-draft.md"
                started_at: null
                completed_at: null

              - id: "ps-critic-003"
                name: "Critic"
                role: "Single-pass review (C1). Apply S-010 self-review."
                status: "BLOCKED"
                strategy_sequence: ["S-010"]
                optional_strategies: ["S-003", "S-014"]
                min_iterations: 1
                artifact: "orchestration/jnsq-20260219-001/jnsq/phase-2-tier1-fanout/feat-003/ps-critic-003/ps-critic-003-review.md"
                inputs:
                  - "orchestration/jnsq-20260219-001/jnsq/phase-2-tier1-fanout/feat-003/ps-creator-003/ps-creator-003-draft.md"
                started_at: null
                completed_at: null

              - id: "adv-scorer-003"
                name: "Quality Scorer"
                role: "S-010 self-review pass/fail. Optional S-014 scoring."
                status: "BLOCKED"
                strategy: "S-010"
                artifact: "orchestration/jnsq-20260219-001/jnsq/phase-2-tier1-fanout/feat-003/adv-scorer-003/adv-scorer-003-quality-score.md"
                started_at: null
                completed_at: null

            quality_score: null

          # ---- FEAT-005: Soundtrack (C1 — Leaf) ----
          - stream_id: "feat-005"
            feature_id: "FEAT-005"
            criticality: "C1"
            critical_path: false
            status: "BLOCKED"

            agents:
              - id: "ps-creator-005"
                name: "Creator"
                role: "Draft Jerry soundtrack: curated music, vibes, sonic identity rationale"
                status: "BLOCKED"
                artifact: "orchestration/jnsq-20260219-001/jnsq/phase-2-tier1-fanout/feat-005/ps-creator-005/ps-creator-005-draft.md"
                inputs:
                  - "orchestration/jnsq-20260219-001/jnsq/phase-1-persona-distillation/ps-creator-001/ps-creator-001-draft.md"
                started_at: null
                completed_at: null

              - id: "ps-critic-005"
                name: "Critic"
                role: "Single-pass review (C1). Apply S-010 self-review."
                status: "BLOCKED"
                strategy_sequence: ["S-010"]
                min_iterations: 1
                artifact: "orchestration/jnsq-20260219-001/jnsq/phase-2-tier1-fanout/feat-005/ps-critic-005/ps-critic-005-review.md"
                inputs:
                  - "orchestration/jnsq-20260219-001/jnsq/phase-2-tier1-fanout/feat-005/ps-creator-005/ps-creator-005-draft.md"
                started_at: null
                completed_at: null

              - id: "adv-scorer-005"
                name: "Quality Scorer"
                role: "S-010 self-review pass/fail."
                status: "BLOCKED"
                strategy: "S-010"
                artifact: "orchestration/jnsq-20260219-001/jnsq/phase-2-tier1-fanout/feat-005/adv-scorer-005/adv-scorer-005-quality-score.md"
                started_at: null
                completed_at: null

            quality_score: null

      # -------------------------------------------------------------------
      # PHASE 3: TIER 2 FAN-OUT (FEAT-004 + FEAT-006 + FEAT-007)
      # -------------------------------------------------------------------
      - id: 3
        name: "Tier 2 Fan-Out"
        path_id: "phase-3-tier2-fanout"
        feature_ids: ["FEAT-004", "FEAT-006", "FEAT-007"]
        execution_mode: "CONCURRENT"
        status: "BLOCKED"
        blocked_by: "barrier-2"
        started_at: null
        completed_at: null

        streams:
          # ---- FEAT-004: Framework Voice & Personality (C2) ----
          - stream_id: "feat-004"
            feature_id: "FEAT-004"
            criticality: "C2"
            status: "BLOCKED"

            agents:
              - id: "ps-creator-004"
                name: "Creator"
                role: "Draft voice guide; apply Saucer Boy voice to CLI output, docs, error messages"
                status: "BLOCKED"
                artifact: "orchestration/jnsq-20260219-001/jnsq/phase-3-tier2-fanout/feat-004/ps-creator-004/ps-creator-004-draft.md"
                inputs:
                  - "orchestration/jnsq-20260219-001/jnsq/phase-1-persona-distillation/ps-creator-001/ps-creator-001-draft.md"
                  - "orchestration/jnsq-20260219-001/jnsq/phase-2-tier1-fanout/feat-002/ps-creator-002/ps-creator-002-draft.md"
                started_at: null
                completed_at: null

              - id: "ps-critic-004"
                name: "Critic"
                role: "Creator-critic-revision loop (min 3 iterations). C2 strategy sequence: S-010 → S-003 → S-002 → S-007."
                status: "BLOCKED"
                strategy_sequence: ["S-010", "S-003", "S-002", "S-007"]
                min_iterations: 3
                iterations_complete: 0
                artifacts:
                  - "orchestration/jnsq-20260219-001/jnsq/phase-3-tier2-fanout/feat-004/ps-critic-004/ps-critic-004-review-r1.md"
                  - "orchestration/jnsq-20260219-001/jnsq/phase-3-tier2-fanout/feat-004/ps-critic-004/ps-critic-004-review-r2.md"
                  - "orchestration/jnsq-20260219-001/jnsq/phase-3-tier2-fanout/feat-004/ps-critic-004/ps-critic-004-review-r3.md"
                inputs:
                  - "orchestration/jnsq-20260219-001/jnsq/phase-3-tier2-fanout/feat-004/ps-creator-004/ps-creator-004-draft.md"
                started_at: null
                completed_at: null

              - id: "adv-scorer-004"
                name: "Quality Scorer"
                role: "Apply S-014. Composite score must reach >= 0.92."
                status: "BLOCKED"
                strategy: "S-014"
                artifact: "orchestration/jnsq-20260219-001/jnsq/phase-3-tier2-fanout/feat-004/adv-scorer-004/adv-scorer-004-quality-score.md"
                started_at: null
                completed_at: null

            quality_score: null

          # ---- FEAT-006: Easter Eggs & Cultural References (C2) ----
          - stream_id: "feat-006"
            feature_id: "FEAT-006"
            criticality: "C2"
            status: "BLOCKED"

            agents:
              - id: "ps-creator-006"
                name: "Creator"
                role: "Design and implement easter eggs in source code and CLI"
                status: "BLOCKED"
                artifact: "orchestration/jnsq-20260219-001/jnsq/phase-3-tier2-fanout/feat-006/ps-creator-006/ps-creator-006-draft.md"
                inputs:
                  - "orchestration/jnsq-20260219-001/jnsq/phase-1-persona-distillation/ps-creator-001/ps-creator-001-draft.md"
                  - "orchestration/jnsq-20260219-001/jnsq/phase-2-tier1-fanout/feat-002/ps-creator-002/ps-creator-002-draft.md"
                started_at: null
                completed_at: null

              - id: "ps-critic-006"
                name: "Critic"
                role: "Creator-critic-revision loop (min 3 iterations). C2 strategy sequence: S-010 → S-003 → S-002 → S-007."
                status: "BLOCKED"
                strategy_sequence: ["S-010", "S-003", "S-002", "S-007"]
                min_iterations: 3
                iterations_complete: 0
                artifacts:
                  - "orchestration/jnsq-20260219-001/jnsq/phase-3-tier2-fanout/feat-006/ps-critic-006/ps-critic-006-review-r1.md"
                  - "orchestration/jnsq-20260219-001/jnsq/phase-3-tier2-fanout/feat-006/ps-critic-006/ps-critic-006-review-r2.md"
                  - "orchestration/jnsq-20260219-001/jnsq/phase-3-tier2-fanout/feat-006/ps-critic-006/ps-critic-006-review-r3.md"
                inputs:
                  - "orchestration/jnsq-20260219-001/jnsq/phase-3-tier2-fanout/feat-006/ps-creator-006/ps-creator-006-draft.md"
                started_at: null
                completed_at: null

              - id: "adv-scorer-006"
                name: "Quality Scorer"
                role: "Apply S-014. Composite score must reach >= 0.92."
                status: "BLOCKED"
                strategy: "S-014"
                artifact: "orchestration/jnsq-20260219-001/jnsq/phase-3-tier2-fanout/feat-006/adv-scorer-006/adv-scorer-006-quality-score.md"
                started_at: null
                completed_at: null

            quality_score: null

          # ---- FEAT-007: Developer Experience Delight (C2) ----
          - stream_id: "feat-007"
            feature_id: "FEAT-007"
            criticality: "C2"
            status: "BLOCKED"

            agents:
              - id: "ps-creator-007"
                name: "Creator"
                role: "Design and implement DX delight features across session hooks and CLI interactions"
                status: "BLOCKED"
                artifact: "orchestration/jnsq-20260219-001/jnsq/phase-3-tier2-fanout/feat-007/ps-creator-007/ps-creator-007-draft.md"
                inputs:
                  - "orchestration/jnsq-20260219-001/jnsq/phase-1-persona-distillation/ps-creator-001/ps-creator-001-draft.md"
                  - "orchestration/jnsq-20260219-001/jnsq/phase-2-tier1-fanout/feat-002/ps-creator-002/ps-creator-002-draft.md"
                started_at: null
                completed_at: null

              - id: "ps-critic-007"
                name: "Critic"
                role: "Creator-critic-revision loop (min 3 iterations). C2 strategy sequence: S-010 → S-003 → S-002 → S-007."
                status: "BLOCKED"
                strategy_sequence: ["S-010", "S-003", "S-002", "S-007"]
                min_iterations: 3
                iterations_complete: 0
                artifacts:
                  - "orchestration/jnsq-20260219-001/jnsq/phase-3-tier2-fanout/feat-007/ps-critic-007/ps-critic-007-review-r1.md"
                  - "orchestration/jnsq-20260219-001/jnsq/phase-3-tier2-fanout/feat-007/ps-critic-007/ps-critic-007-review-r2.md"
                  - "orchestration/jnsq-20260219-001/jnsq/phase-3-tier2-fanout/feat-007/ps-critic-007/ps-critic-007-review-r3.md"
                inputs:
                  - "orchestration/jnsq-20260219-001/jnsq/phase-3-tier2-fanout/feat-007/ps-creator-007/ps-creator-007-draft.md"
                started_at: null
                completed_at: null

              - id: "adv-scorer-007"
                name: "Quality Scorer"
                role: "Apply S-014. Composite score must reach >= 0.92."
                status: "BLOCKED"
                strategy: "S-014"
                artifact: "orchestration/jnsq-20260219-001/jnsq/phase-3-tier2-fanout/feat-007/adv-scorer-007/adv-scorer-007-quality-score.md"
                started_at: null
                completed_at: null

            quality_score: null

        # Fan-In Synthesis (after all Phase 3 streams complete)
        synthesis_agent:
          id: "synth-001"
          name: "Fan-In Synthesizer"
          role: "Cross-feature coherence audit; persona consistency check; produce final EPIC-001 synthesis"
          status: "BLOCKED"
          artifact: "orchestration/jnsq-20260219-001/synthesis/synth-001-epic001-final-synthesis.md"
          inputs:
            - "orchestration/jnsq-20260219-001/jnsq/phase-3-tier2-fanout/feat-004/ps-creator-004/ps-creator-004-draft.md"
            - "orchestration/jnsq-20260219-001/jnsq/phase-3-tier2-fanout/feat-006/ps-creator-006/ps-creator-006-draft.md"
            - "orchestration/jnsq-20260219-001/jnsq/phase-3-tier2-fanout/feat-007/ps-creator-007/ps-creator-007-draft.md"
          started_at: null
          completed_at: null

# =============================================================================
# QUALITY GATE BARRIERS
# =============================================================================
barriers:
  - id: "barrier-1"
    name: "Phase 1 Quality Gate"
    description: "FEAT-001 must achieve >= 0.92 composite S-014 score before Phase 2 unlocks"
    status: "PENDING"  # PENDING | IN_PROGRESS | COMPLETE | FAILED
    threshold: 0.92
    criticality: "C2"
    completed_at: null
    depends_on:
      - "jnsq.phase.1"  # All Phase 1 agents complete
    gate_condition:
      primary: "jnsq.phase.1.feat-001.quality_score >= 0.92"
    on_pass: "Unblock Phase 2 (all three streams: feat-002, feat-003, feat-005)"
    on_fail: "Return to ps-critic-001; targeted revision; re-score with adv-scorer-001"
    max_retries: 2  # Beyond the mandatory 3 iterations (H-14)
    retry_count: 0
    score_recorded: 0.925

  - id: "barrier-2"
    name: "Phase 2 Quality Gate"
    description: "FEAT-002 must achieve >= 0.92 (critical path). FEAT-003 and FEAT-005 must pass C1 self-review."
    status: "BLOCKED"
    threshold_c3: 0.92   # FEAT-002 (critical path gate)
    threshold_c1: null   # C1: pass/fail self-review only (no numeric threshold)
    criticality_primary: "C3"
    completed_at: null
    depends_on:
      - "jnsq.phase.2.feat-002.quality_score"   # Critical path
      - "jnsq.phase.2.feat-003.quality_score"   # Leaf
      - "jnsq.phase.2.feat-005.quality_score"   # Leaf
    gate_conditions:
      critical_path: "jnsq.phase.2.feat-002.quality_score >= 0.92"
      leaf_003: "jnsq.phase.2.feat-003.s010_pass == true"
      leaf_005: "jnsq.phase.2.feat-005.s010_pass == true"
    on_pass: "Unblock Phase 3 (all three streams: feat-004, feat-006, feat-007)"
    on_fail: "Return to failing stream; targeted revision; re-score"
    max_retries: 2
    retry_count: 0
    score_recorded: null

# =============================================================================
# ADVERSARIAL STRATEGY CONFIGURATION
# =============================================================================
adversarial:
  # Source: quality-enforcement.md Strategy Catalog
  quality_threshold: 0.92  # H-13

  strategy_sets:
    C1:
      required: ["S-010"]
      optional: ["S-003", "S-014"]
      min_iterations: 1

    C2:
      required: ["S-007", "S-002", "S-014"]
      optional: ["S-003", "S-010"]
      h16_enforced: true  # S-003 MUST precede S-002 when both applied
      canonical_sequence: ["S-010", "S-003", "S-002", "S-007", "S-014"]
      min_iterations: 3

    C3:
      required: ["S-007", "S-002", "S-014", "S-004", "S-012", "S-013"]
      optional: ["S-001", "S-003", "S-010", "S-011"]
      h16_enforced: true
      canonical_sequence: ["S-010", "S-003", "S-002", "S-007", "S-004", "S-012", "S-013", "S-014"]
      min_iterations: 3

    C4:
      required: ["S-001", "S-002", "S-003", "S-004", "S-007", "S-010", "S-011", "S-012", "S-013", "S-014"]
      mode: "tournament"
      min_iterations: 3

  feature_criticality:
    FEAT-001: "C2"
    FEAT-002: "C3"
    FEAT-003: "C1"
    FEAT-004: "C2"
    FEAT-005: "C1"
    FEAT-006: "C2"
    FEAT-007: "C2"

  quality_scores:
    FEAT-001: null  # Populated by adv-scorer-001
    FEAT-002: null  # Populated by adv-scorer-002
    FEAT-003: null  # Populated by adv-scorer-003 (pass/fail)
    FEAT-004: null  # Populated by adv-scorer-004
    FEAT-005: null  # Populated by adv-scorer-005 (pass/fail)
    FEAT-006: null  # Populated by adv-scorer-006
    FEAT-007: null  # Populated by adv-scorer-007

# =============================================================================
# EXECUTION QUEUE
# =============================================================================
execution_queue:
  current_group: 1
  groups:
    - id: 1
      name: "Phase 1: Persona Distillation"
      execution_mode: "SEQUENTIAL"
      status: "READY"
      agents: ["ps-researcher-001", "ps-creator-001", "ps-critic-001", "adv-scorer-001"]

    - id: 2
      name: "Barrier 1: Quality Gate Evaluation"
      execution_mode: "SEQUENTIAL"
      status: "BLOCKED"
      blocked_by: "group-1"
      tasks:
        - "evaluate-feat-001-score-vs-threshold"
        - "update-barrier-1-status"
        - "unblock-phase-2-if-pass"

    - id: 3
      name: "Phase 2: Tier 1 Fan-Out"
      execution_mode: "PARALLEL"
      status: "BLOCKED"
      blocked_by: "group-2"
      streams:
        - stream: "feat-002"
          agents: ["ps-researcher-002", "ps-creator-002", "ps-critic-002", "adv-scorer-002"]
        - stream: "feat-003"
          agents: ["ps-creator-003", "ps-critic-003", "adv-scorer-003"]
        - stream: "feat-005"
          agents: ["ps-creator-005", "ps-critic-005", "adv-scorer-005"]

    - id: 4
      name: "Barrier 2: Quality Gate Evaluation"
      execution_mode: "SEQUENTIAL"
      status: "BLOCKED"
      blocked_by: "group-3"
      tasks:
        - "evaluate-feat-002-score-vs-threshold"   # Critical path
        - "evaluate-feat-003-s010-pass"
        - "evaluate-feat-005-s010-pass"
        - "update-barrier-2-status"
        - "unblock-phase-3-if-all-pass"

    - id: 5
      name: "Phase 3: Tier 2 Fan-Out"
      execution_mode: "PARALLEL"
      status: "BLOCKED"
      blocked_by: "group-4"
      streams:
        - stream: "feat-004"
          agents: ["ps-creator-004", "ps-critic-004", "adv-scorer-004"]
        - stream: "feat-006"
          agents: ["ps-creator-006", "ps-critic-006", "adv-scorer-006"]
        - stream: "feat-007"
          agents: ["ps-creator-007", "ps-critic-007", "adv-scorer-007"]

    - id: 6
      name: "Phase 3: Fan-In Synthesis"
      execution_mode: "SEQUENTIAL"
      status: "BLOCKED"
      blocked_by: "group-5"
      agents: ["synth-001"]

# =============================================================================
# CHECKPOINTS
# =============================================================================
checkpoints:
  latest_id: null
  entries: []
  # Checkpoint triggers: PHASE_COMPLETE, BARRIER_COMPLETE, MANUAL
  # Example entry format:
  # - id: "CP-001"
  #   timestamp: "2026-02-19T00:00:00Z"
  #   trigger: "PHASE_COMPLETE"
  #   description: "Phase 1 complete; barrier-1 passed with score 0.94"
  #   recovery_point: "phase-2-start"

# =============================================================================
# METRICS
# =============================================================================
metrics:
  execution:
    phases_complete: 0
    phases_total: 3
    phases_percent: 0
    barriers_complete: 0
    barriers_total: 2
    barriers_percent: 0
    streams_complete: 0
    streams_total: 7    # 1 (Phase 1) + 3 (Phase 2) + 3 (Phase 3)
    agents_executed: 0
    agents_total: 20    # All agents across all phases
    agents_percent: 0
    artifacts_created: 0
    artifacts_total: 24   # Phase artifacts + quality score files + synthesis
    artifacts_percent: 0

  quality:
    avg_score_c2_features: null   # Average across FEAT-001, FEAT-004, FEAT-006, FEAT-007
    feat_002_score: null          # C3 feature tracked separately
    c1_features_passed: 0
    c1_features_total: 2          # FEAT-003, FEAT-005
    gate_pass_rate: null
    total_critic_iterations: 0
    min_required_iterations: 14   # 3×FEAT-001 + 3×FEAT-002 + 1×FEAT-003 + 3×FEAT-004 + 1×FEAT-005 + 3×FEAT-006 + ... wait, let me recount
    # Phase 1: 3 (FEAT-001 C2)
    # Phase 2: 3 (FEAT-002 C3) + 1 (FEAT-003 C1) + 1 (FEAT-005 C1) = 5
    # Phase 3: 3 (FEAT-004 C2) + 3 (FEAT-006 C2) + 3 (FEAT-007 C2) = 9
    # Total minimum: 17

  timing:
    workflow_started: null
    last_activity: null
    estimated_completion: null

# =============================================================================
# BLOCKERS AND ISSUES
# =============================================================================
blockers:
  active: []

issues:
  resolved: []

# =============================================================================
# NEXT ACTIONS
# =============================================================================
next_actions:
  immediate:
    - action: "Invoke /problem-solving for FEAT-001. Start ps-researcher-001."
      context: "Load: projects/PROJ-003-je-ne-sais-quoi/work/EPIC-001-je-ne-sais-quoi/EPIC-001-je-ne-sais-quoi.md and docs/knowledge/"
      agents: ["ps-researcher-001"]
      execution_mode: "SEQUENTIAL"

  subsequent:
    - action: "Run ps-creator-001 draft pass"
      depends_on: "ps-researcher-001 complete"

    - action: "Run ps-critic-001 creator-critic loop (min 3 iterations, C2 strategies)"
      depends_on: "ps-creator-001 complete"
      strategy_sequence: ["S-010", "S-003", "S-002", "S-007"]

    - action: "Invoke /adversary (adv-scorer-001) for S-014 quality scoring"
      depends_on: "ps-critic-001 >= 3 iterations complete"

    - action: "Evaluate Barrier 1: score >= 0.92?"
      depends_on: "adv-scorer-001 complete"
      branch:
        pass: "Unblock Phase 2; invoke FEAT-002/003/005 fan-out"
        fail: "Targeted revision; re-iterate ps-critic-001; re-score"

    - action: "Phase 2 fan-out: invoke /architecture for FEAT-002; creative streams for FEAT-003/005"
      depends_on: "barrier-1 COMPLETE"

    - action: "Evaluate Barrier 2: FEAT-002 >= 0.92 + FEAT-003/005 S-010 pass?"
      depends_on: "All Phase 2 streams complete"

    - action: "Phase 3 fan-out: /problem-solving for FEAT-004/007; coding for FEAT-006"
      depends_on: "barrier-2 COMPLETE"

    - action: "Fan-in synthesis via synth-001"
      depends_on: "All Phase 3 streams complete"

# =============================================================================
# RESUMPTION CONTEXT
# =============================================================================
resumption:
  last_checkpoint: null
  current_state: "Workflow not started. Phase 1 (FEAT-001) is the immediate next action."
  next_step: "Execute ps-researcher-001 for FEAT-001 persona research"

  files_to_read:
    - path: "projects/PROJ-003-je-ne-sais-quoi/ORCHESTRATION.yaml"
      purpose: "This file - machine-readable state SSOT (load first)"
    - path: "projects/PROJ-003-je-ne-sais-quoi/ORCHESTRATION_PLAN.md"
      purpose: "Strategic context, ASCII diagrams, phase details"
    - path: "projects/PROJ-003-je-ne-sais-quoi/WORKTRACKER.md"
      purpose: "Task tracking"
    - path: "projects/PROJ-003-je-ne-sais-quoi/work/EPIC-001-je-ne-sais-quoi/EPIC-001-je-ne-sais-quoi.md"
      purpose: "EPIC context and feature specifications"

  cross_session_portable: true
  ephemeral_references: false
  disclaimer: "Generated by orch-planner v2.1.0. All paths repository-relative."
