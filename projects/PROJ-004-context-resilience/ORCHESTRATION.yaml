# ORCHESTRATION.yaml
# Machine-readable orchestration state for SPIKE-001 Context Research
# Document ID: PROJ-004-ORCH-STATE
# Version: 2.0
# Last Updated: 2026-02-19
# Generated by: orch-planner agent v2.2.0
# Disclaimer: All paths use dynamic identifiers. No hardcoded pipeline names.
# Schema Evolution: See docs/schemas/SCHEMA_VERSIONING.md

# Schema version for evolution support (semver format)
# Increment MAJOR for breaking changes, MINOR for additions, PATCH for fixes
schema_version: "2.0.0"

# =============================================================================
# WORKFLOW METADATA
# =============================================================================
workflow:
  id: "spike001-ctxres-20260219-001"
  name: "SPIKE-001 Context Measurement, Detection Thresholds & Resumption Protocols Research"
  project_id: "PROJ-004"
  version: "2.0"
  created_at: "2026-02-19T00:00:00Z"
  updated_at: "2026-02-19T00:00:00Z"
  status: "ACTIVE"  # ACTIVE | PAUSED | COMPLETE | FAILED | CANCELLED

  # Workflow ID configuration (WI-SAO-021)
  id_source: "auto"               # "user" | "auto" - how the workflow ID was determined
  id_format: "semantic-date-seq"  # Format specification
  # Format: {purpose}-{YYYYMMDD}-{NNN}
  # Generated: spike001-ctxres-20260219-001

  # Spike entity reference
  spike_entity: "projects/PROJ-004-context-resilience/work/EPIC-001-context-resilience/FEAT-001-context-detection/SPIKE-001-context-research.md"

  # Criticality classification
  criticality: "C2"               # C1 Routine | C2 Standard | C3 Significant | C4 Critical
  criticality_rationale: "Research spike producing 7-10 artifact files. Reversible within 1 day. No code changes — findings inform future implementation."

  # Timebox
  timebox_hours: 8

  # Orchestration pattern classification
  patterns:
    - SEQUENTIAL      # Phases 1-7 execute in strict order
    - HIERARCHICAL    # Orchestrator delegates to execution agents

  # Constraints from Jerry Constitution
  constraints:
    max_agent_nesting: 1          # P-003: Single nesting only
    file_persistence: true        # P-002: All state to filesystem
    user_authority: true          # P-020: User approves when max iterations hit
    max_concurrent_agents: 1      # Sequential pipeline — one agent at a time
    max_gate_retries: 3           # H-14: Max 3 iterations per gate (circuit breaker)
    checkpoint_frequency: "PHASE" # AGENT | PHASE | BARRIER

# =============================================================================
# PATH CONFIGURATION (WI-SAO-021)
# =============================================================================
# All paths are dynamically constructed using workflow and pipeline identifiers.
# No hardcoded pipeline names — all derived from configuration below.
paths:
  # Base path for all orchestration artifacts (relative to project root)
  base: "projects/PROJ-004-context-resilience/orchestration/spike001-ctxres-20260219-001/"

  # Pipeline artifact path pattern
  # {pipeline_alias} = "res"
  # {phase_id} = "phase-1-inventory", "phase-2-analysis", etc.
  # {agent_id} = agent subdirectory for isolation (AC-012-004)
  pipeline: "{base}res/{phase_id}/{agent_id}/"

  # Quality gate artifact path pattern
  gates: "{base}res/quality-gates/{gate_id}/"

  # Examples (with workflow.id = "spike001-ctxres-20260219-001"):
  # - Phase 1:  projects/PROJ-004-context-resilience/orchestration/spike001-ctxres-20260219-001/res/phase-1-inventory/research-inventory/mechanism-inventory.md
  # - QG-1:     projects/PROJ-004-context-resilience/orchestration/spike001-ctxres-20260219-001/res/quality-gates/qg-1/gate-result.md

# =============================================================================
# PIPELINE DEFINITIONS
# =============================================================================
pipelines:
  res:
    id: "res"
    name: "Context Research Pipeline"
    description: "Single sequential pipeline implementing 7-phase research spike for context measurement, detection thresholds, and resumption protocols"
    short_alias: "res"
    skill_source: "problem-solving"

    status: "QG_2_IN_PROGRESS"
    current_phase: 6
    total_phases: 7
    progress_percent: 85

    phases:

      # -----------------------------------------------------------------------
      # PHASE 1: INVENTORY EXISTING MECHANISMS
      # -----------------------------------------------------------------------
      - id: 1
        name: "Inventory Existing Mechanisms"
        path_id: "phase-1-inventory"
        status: "COMPLETE"
        execution_mode: "SEQUENTIAL"
        effort_points: 1
        started_at: "2026-02-19T00:00:00Z"
        completed_at: "2026-02-19T00:00:00Z"
        gate_after: null  # Lightweight checkpoint only

        agents:
          - id: "research-inventory"
            name: "Mechanism Inventory Researcher"
            status: "COMPLETE"
            artifact: "orchestration/spike001-ctxres-20260219-001/res/phase-1-inventory/research-inventory/mechanism-inventory.md"
            inputs:
              - "Claude Code session APIs documentation"
              - "Hook system documentation ($TRANSCRIPT_PATH, prompt hooks)"
              - "System-reminder message format"
              - ".context/rules/quality-enforcement.md (AE-006)"
              - "Context7 research findings"
            description: >
              Audit Claude Code session APIs, hook system, and system-reminder messages
              for context fill indicators. Review AE-006 (token exhaustion escalation)
              for existing handling. Document all mechanisms with capabilities and limitations.

        artifacts:
          - path: "orchestration/spike001-ctxres-20260219-001/res/phase-1-inventory/research-inventory/mechanism-inventory.md"
            status: "PENDING"
            agent: "research-inventory"

      # -----------------------------------------------------------------------
      # PHASE 2: ANALYZE REAL ORCHESTRATION RUNS
      # -----------------------------------------------------------------------
      - id: 2
        name: "Analyze Real Orchestration Runs"
        path_id: "phase-2-analysis"
        status: "COMPLETE"
        blocked_by: null
        execution_mode: "SEQUENTIAL"
        effort_points: 2
        started_at: "2026-02-19T00:00:00Z"
        completed_at: "2026-02-19T00:00:00Z"
        completed_at: null
        gate_after: null  # Lightweight checkpoint only

        agents:
          - id: "run-analyzer"
            name: "Orchestration Run Analyzer"
            status: "COMPLETE"
            artifact: "orchestration/spike001-ctxres-20260219-001/res/phase-2-analysis/run-analyzer/run-analysis.md"
            inputs:
              - "projects/PROJ-001-oss-release/ORCHESTRATION.yaml"
              - "projects/PROJ-001-oss-release/ORCHESTRATION_PLAN.md"
              - "Phase 1 mechanism inventory"
            description: >
              Examine PROJ-001 orchestration runs for context exhaustion patterns.
              Identify when context limits were hit, what state was lost, and how
              resumption was handled. Extract empirical data on context fill rates.

        artifacts:
          - path: "orchestration/spike001-ctxres-20260219-001/res/phase-2-analysis/run-analyzer/run-analysis.md"
            status: "PENDING"
            agent: "run-analyzer"

      # -----------------------------------------------------------------------
      # PHASE 3: EVALUATE DETECTION METHODS
      # -----------------------------------------------------------------------
      - id: 3
        name: "Evaluate Detection Methods"
        path_id: "phase-3-detection"
        status: "COMPLETE"
        blocked_by: "phase-2"
        execution_mode: "SEQUENTIAL"
        effort_points: 2
        started_at: null
        completed_at: null
        gate_after: "qg-1"  # Full quality gate — key decision point

        agents:
          - id: "detection-evaluator"
            name: "Detection Method Evaluator"
            status: "COMPLETE"
            artifact: "orchestration/spike001-ctxres-20260219-001/res/phase-3-detection/detection-evaluator/detection-evaluation.md"
            inputs:
              - "Phase 1 mechanism inventory"
              - "Phase 2 run analysis"
              - "Context7 API findings (count_tokens, context_management.edits, usage objects)"
            description: >
              Compare 4 detection methods: (a) token counting heuristics, (b) Claude Code
              context compaction detection, (c) hook-based monitoring, (d) response quality
              degradation signals. Score by reliability (0.35), overhead (0.25),
              implementation complexity (0.25), fail-safe behavior (0.15). Produce
              recommendation with justification.

        artifacts:
          - path: "orchestration/spike001-ctxres-20260219-001/res/phase-3-detection/detection-evaluator/detection-evaluation.md"
            status: "PENDING"
            agent: "detection-evaluator"

      # -----------------------------------------------------------------------
      # PHASE 4: ASSESS RESUMPTION COMPLETENESS
      # -----------------------------------------------------------------------
      - id: 4
        name: "Assess Resumption Completeness"
        path_id: "phase-4-resumption"
        status: "BLOCKED"
        blocked_by: "qg-1"  # Blocked by quality gate, not just phase
        execution_mode: "SEQUENTIAL"
        effort_points: 1
        started_at: null
        completed_at: null
        gate_after: null  # Lightweight checkpoint only

        agents:
          - id: "resumption-assessor"
            name: "Resumption Completeness Assessor"
            status: "COMPLETE"
            artifact: "orchestration/spike001-ctxres-20260219-001/res/phase-4-resumption/resumption-assessor/resumption-assessment.md"
            inputs:
              - "Phase 2 run analysis"
              - "projects/PROJ-001-oss-release/ORCHESTRATION.yaml (resumption section)"
              - "ORCHESTRATION.yaml template schema"
            description: >
              Review existing ORCHESTRATION.yaml resumption sections from real workflows.
              Identify gaps — what information is missing for reliable self-orientation?
              What does an operator currently have to supply manually? Enumerate missing
              state elements and compare current vs required resumption data.

        artifacts:
          - path: "orchestration/spike001-ctxres-20260219-001/res/phase-4-resumption/resumption-assessor/resumption-assessment.md"
            status: "PENDING"
            agent: "resumption-assessor"

      # -----------------------------------------------------------------------
      # PHASE 5: DESIGN RESUMPTION PROMPT
      # -----------------------------------------------------------------------
      - id: 5
        name: "Design Resumption Prompt"
        path_id: "phase-5-prompt"
        status: "BLOCKED"
        blocked_by: "phase-4"
        execution_mode: "SEQUENTIAL"
        effort_points: 1
        started_at: null
        completed_at: null
        gate_after: null  # Lightweight checkpoint only

        agents:
          - id: "prompt-designer"
            name: "Resumption Prompt Designer"
            status: "COMPLETE"
            artifact: "orchestration/spike001-ctxres-20260219-001/res/phase-5-prompt/prompt-designer/resumption-prompt-template.md"
            inputs:
              - "Phase 4 resumption assessment"
              - "ORCHESTRATION.yaml schema"
              - "WORKTRACKER.md format"
              - "projects/PROJ-001-oss-release/ORCHESTRATION.yaml (real snapshot)"
            description: >
              Draft a structured prompt template that reads ORCHESTRATION.yaml + WORKTRACKER.md
              and outputs a resumption plan. Must handle partially-complete phases and failed
              quality gates. Test mentally against real workflow snapshots from PROJ-001.

        artifacts:
          - path: "orchestration/spike001-ctxres-20260219-001/res/phase-5-prompt/prompt-designer/resumption-prompt-template.md"
            status: "PENDING"
            agent: "prompt-designer"

      # -----------------------------------------------------------------------
      # PHASE 6: PROPOSE THRESHOLDS
      # -----------------------------------------------------------------------
      - id: 6
        name: "Propose Thresholds"
        path_id: "phase-6-thresholds"
        status: "BLOCKED"
        blocked_by: "phase-5"
        execution_mode: "SEQUENTIAL"
        effort_points: 1
        started_at: null
        completed_at: null
        gate_after: "qg-2"  # Full quality gate — threshold validation

        agents:
          - id: "threshold-analyst"
            name: "Threshold Analyst"
            status: "COMPLETE"
            artifact: "orchestration/spike001-ctxres-20260219-001/res/phase-6-thresholds/threshold-analyst/threshold-proposal.md"
            inputs:
              - "Phase 2 run analysis (empirical data)"
              - "Phase 3 detection method capabilities"
              - "Phase 5 resumption prompt (token cost estimate)"
            description: >
              Based on real data, propose warning and critical thresholds. Consider: how
              much token budget is needed for a graceful checkpoint? How much degradation
              occurs at various fill levels? Propose ranges by orchestration pattern and
              criticality level. Include token budget analysis for checkpoint operations.

        artifacts:
          - path: "orchestration/spike001-ctxres-20260219-001/res/phase-6-thresholds/threshold-analyst/threshold-proposal.md"
            status: "PENDING"
            agent: "threshold-analyst"

      # -----------------------------------------------------------------------
      # PHASE 7: SYNTHESIZE FINDINGS
      # -----------------------------------------------------------------------
      - id: 7
        name: "Synthesize Findings"
        path_id: "phase-7-synthesis"
        status: "BLOCKED"
        blocked_by: "qg-2"  # Blocked by quality gate, not just phase
        execution_mode: "SEQUENTIAL"
        effort_points: 1
        started_at: null
        completed_at: null
        gate_after: null  # No gate — final synthesis

        agents:
          - id: "spike-synthesizer"
            name: "Spike Research Synthesizer"
            status: "BLOCKED"
            artifact: "orchestration/spike001-ctxres-20260219-001/res/phase-7-synthesis/spike-synthesizer/spike-synthesis.md"
            inputs:
              - "All phase artifacts (Phases 1-6)"
              - "QG-1 and QG-2 gate results"
              - "SPIKE-001 entity (template for Findings/Recommendation sections)"
            outputs:
              - "orchestration/spike001-ctxres-20260219-001/res/phase-7-synthesis/spike-synthesizer/spike-synthesis.md"
              - "projects/PROJ-004-context-resilience/work/EPIC-001-context-resilience/FEAT-001-context-detection/SPIKE-001-context-research.md (updated)"
            description: >
              Document findings, recommendation, and follow-up work items. Populate
              SPIKE-001 Findings and Recommendation sections. Produce L0 stakeholder
              summary, L1 detailed findings, and follow-up work items for FEAT-001.

        artifacts:
          - path: "orchestration/spike001-ctxres-20260219-001/res/phase-7-synthesis/spike-synthesizer/spike-synthesis.md"
            status: "PENDING"
            agent: "spike-synthesizer"

# =============================================================================
# QUALITY GATES
# =============================================================================
# C2 Required Strategies: S-014 (LLM-as-Judge), S-007 (Constitutional AI Critique), S-002 (Devil's Advocate)
# H-16 Ordering: S-003 (Steelman) MUST precede S-002 (Devil's Advocate) if applied
# Threshold: >= 0.92 (H-13)
# Max iterations: 3 (H-14)
quality_gates:

  qg-1:
    id: "qg-1"
    name: "Detection Method Selection Gate"
    after_phase: 3
    status: "PASS"  # PENDING | IN_PROGRESS | PASS | FAIL | ESCALATED
    rationale: "Detection method selection is the key architectural decision. Getting this wrong invalidates Phases 4-7."
    deliverables_scored:
      - "orchestration/spike001-ctxres-20260219-001/res/phase-3-detection/detection-evaluator/detection-evaluation.md"
    threshold: 0.92
    max_iterations: 3
    current_iteration: 2
    required_strategies: ["S-014", "S-007", "S-002"]
    optional_strategies: ["S-003", "S-010"]
    agents_invoked: ["adv-scorer"]
    iteration_history:
      - iteration: 1
        score: 0.91
        verdict: "REVISE"
        strategies:
          S-014: { score: 0.91, verdict: "REVISE" }
          S-007: { score: 0.98, verdict: "PASS" }
          S-002: { verdict: "NO-BLOCK", major_findings: 4, minor_findings: 3 }
        primary_defect: "Methodological Rigor 0.87 (no sensitivity analysis, thresholds definitive). Evidence Quality 0.88 (unvalidated input_tokens proxy, OQ-3 assumption)."
      - iteration: 2
        score: 0.93
        verdict: "PASS"
        strategies:
          S-014: { score: 0.93, verdict: "PASS" }
          S-007: { score: 0.98, verdict: "PASS" }
          S-002: { verdict: "NO-BLOCK", major_findings: 0, minor_findings: 1 }
        primary_defect: null
    score: 0.93
    score_dimensions:
      completeness: 0.93      # weight: 0.20
      internal_consistency: 0.93  # weight: 0.20
      methodological_rigor: 0.92  # weight: 0.20
      evidence_quality: 0.92  # weight: 0.15
      actionability: null     # weight: 0.15
      traceability: null      # weight: 0.10
    artifact: "orchestration/spike001-ctxres-20260219-001/res/quality-gates/qg-1/gate-result.md"
    completed_at: null

  qg-2:
    id: "qg-2"
    name: "Threshold Proposal Validation Gate"
    after_phase: 6
    status: "PENDING"
    rationale: "Threshold values directly determine detection efficacy. Incorrect thresholds cause premature or late triggering."
    deliverables_scored:
      - "orchestration/spike001-ctxres-20260219-001/res/phase-6-thresholds/threshold-analyst/threshold-proposal.md"
    threshold: 0.92
    max_iterations: 3
    current_iteration: 0
    required_strategies: ["S-014", "S-007", "S-002"]
    optional_strategies: ["S-003", "S-010"]
    agents_invoked: []
    iteration_history: []
    score: null
    score_dimensions:
      completeness: null      # weight: 0.20
      internal_consistency: null  # weight: 0.20
      methodological_rigor: null  # weight: 0.20
      evidence_quality: null  # weight: 0.15
      actionability: null     # weight: 0.15
      traceability: null      # weight: 0.10
    artifact: "orchestration/spike001-ctxres-20260219-001/res/quality-gates/qg-2/gate-result.md"
    completed_at: null

# =============================================================================
# EXECUTION QUEUE
# =============================================================================
execution_queue:
  current_group: 1
  groups:

    - id: 1
      name: "Phase 1 — Inventory Existing Mechanisms"
      execution_mode: "SEQUENTIAL"
      status: "READY"
      agents: ["research-inventory"]

    - id: 2
      name: "Phase 2 — Analyze Real Orchestration Runs"
      execution_mode: "SEQUENTIAL"
      status: "BLOCKED"
      blocked_by: "group-1"
      agents: ["run-analyzer"]

    - id: 3
      name: "Phase 3 — Evaluate Detection Methods"
      execution_mode: "SEQUENTIAL"
      status: "BLOCKED"
      blocked_by: "group-2"
      agents: ["detection-evaluator"]

    - id: 4
      name: "Quality Gate 1 — Detection Method Selection"
      execution_mode: "SEQUENTIAL"
      status: "BLOCKED"
      blocked_by: "group-3"
      tasks: ["run-adv-scorer-qg1", "run-adv-executor-s007-qg1", "run-adv-executor-s002-qg1"]

    - id: 5
      name: "Phase 4 — Assess Resumption Completeness"
      execution_mode: "SEQUENTIAL"
      status: "BLOCKED"
      blocked_by: "group-4"
      agents: ["resumption-assessor"]

    - id: 6
      name: "Phase 5 — Design Resumption Prompt"
      execution_mode: "SEQUENTIAL"
      status: "BLOCKED"
      blocked_by: "group-5"
      agents: ["prompt-designer"]

    - id: 7
      name: "Phase 6 — Propose Thresholds"
      execution_mode: "SEQUENTIAL"
      status: "BLOCKED"
      blocked_by: "group-6"
      agents: ["threshold-analyst"]

    - id: 8
      name: "Quality Gate 2 — Threshold Proposal Validation"
      execution_mode: "SEQUENTIAL"
      status: "BLOCKED"
      blocked_by: "group-7"
      tasks: ["run-adv-scorer-qg2", "run-adv-executor-s007-qg2", "run-adv-executor-s002-qg2"]

    - id: 9
      name: "Phase 7 — Synthesize Findings"
      execution_mode: "SEQUENTIAL"
      status: "BLOCKED"
      blocked_by: "group-8"
      agents: ["spike-synthesizer"]

# =============================================================================
# CHECKPOINTS
# =============================================================================
checkpoints:
  latest_id: null
  entries: []
  # Checkpoint entries will be created as phases complete:
  # - id: "CP-001"
  #   timestamp: "2026-02-19T..."
  #   trigger: "PHASE_COMPLETE"
  #   description: "Phase 1 complete — mechanism inventory produced"
  #   recovery_point: "phase-2-start"
  # - id: "CP-002"
  #   timestamp: "..."
  #   trigger: "PHASE_COMPLETE"
  #   description: "Phase 2 complete — run analysis produced"
  #   recovery_point: "phase-3-start"
  # - id: "CP-003"
  #   timestamp: "..."
  #   trigger: "GATE_PASS"
  #   description: "QG-1 PASS — detection method selected, Phase 4 unblocked"
  #   recovery_point: "phase-4-start"
  # - id: "CP-004"
  #   timestamp: "..."
  #   trigger: "PHASE_COMPLETE"
  #   description: "Phase 4 complete — resumption assessment produced"
  #   recovery_point: "phase-5-start"
  # - id: "CP-005"
  #   timestamp: "..."
  #   trigger: "PHASE_COMPLETE"
  #   description: "Phase 5 complete — resumption prompt designed"
  #   recovery_point: "phase-6-start"
  # - id: "CP-006"
  #   timestamp: "..."
  #   trigger: "GATE_PASS"
  #   description: "QG-2 PASS — thresholds validated, Phase 7 unblocked"
  #   recovery_point: "phase-7-start"

# =============================================================================
# METRICS
# =============================================================================
metrics:
  execution:
    phases_complete: 0
    phases_total: 7
    phases_percent: 0
    gates_passed: 0
    gates_total: 2
    gates_percent: 0
    agents_executed: 0
    agents_total: 7
    agents_percent: 0
    artifacts_created: 0
    artifacts_total: 9  # 7 phase artifacts + 2 gate result artifacts
    artifacts_percent: 0
    effort_complete: 0
    effort_total: 9  # 1+2+2+1+1+1+1

  quality:
    qg_1_score: null
    qg_2_score: null
    gates_passed_first_attempt: 0
    gates_requiring_revision: 0
    gates_escalated_to_user: 0
    overall_quality_status: "NOT_STARTED"  # NOT_STARTED | IN_PROGRESS | ALL_GATES_PASS | GATE_FAILED

  timing:
    workflow_started: null
    last_activity: null
    estimated_completion: null
    timebox_hours: 8
    timebox_remaining: 8

# =============================================================================
# BLOCKERS AND ISSUES
# =============================================================================
blockers:
  active: []

issues:
  resolved: []

# =============================================================================
# NEXT ACTIONS
# =============================================================================
next_actions:
  immediate:
    - action: "Execute Phase 1 agent research-inventory"
      agents: ["research-inventory"]
      execution_mode: "SEQUENTIAL"
      status: "READY"
      instructions: >
        Audit Claude Code session APIs, hook system, and system-reminder messages for
        context fill indicators. Review AE-006 (token exhaustion escalation) for existing
        handling. Use Context7 research findings as input. Persist mechanism inventory
        artifact at orchestration/spike001-ctxres-20260219-001/res/phase-1-inventory/research-inventory/mechanism-inventory.md

  subsequent:
    - action: "Execute Phase 2 agent run-analyzer"
      depends_on: "Phase 1 complete"
    - action: "Execute Phase 3 agent detection-evaluator"
      depends_on: "Phase 2 complete"
    - action: "Run QG-1 (Detection Method Selection Gate)"
      depends_on: "Phase 3 complete"
    - action: "Execute Phase 4 agent resumption-assessor"
      depends_on: "QG-1 PASS"
    - action: "Execute Phase 5 agent prompt-designer"
      depends_on: "Phase 4 complete"
    - action: "Execute Phase 6 agent threshold-analyst"
      depends_on: "Phase 5 complete"
    - action: "Run QG-2 (Threshold Proposal Validation Gate)"
      depends_on: "Phase 6 complete"
    - action: "Execute Phase 7 agent spike-synthesizer"
      depends_on: "QG-2 PASS"

# =============================================================================
# RESUMPTION CONTEXT
# =============================================================================
resumption:
  last_checkpoint: null
  current_state: "Workflow initialized. Phase 1 ready for execution. No phases started."
  next_step: "Execute Phase 1 agent research-inventory."

  files_to_read:
    - "projects/PROJ-004-context-resilience/ORCHESTRATION_PLAN.md"   # Strategic context
    - "projects/PROJ-004-context-resilience/ORCHESTRATION.yaml"       # This file — machine-readable state (SSOT)
    - "projects/PROJ-004-context-resilience/WORKTRACKER.md"           # Tactical documentation

  context7_inputs:
    - "Anthropic API POST /v1/messages/count_tokens — token counting before sending"
    - "context_management.edits — trigger-based context clearing (clear_tool_uses threshold)"
    - "Usage objects — input_tokens, output_tokens, iterations with compaction entries"
    - "Claude Code hooks — $TRANSCRIPT_PATH for session transcript analysis"
    - "Prompt hooks — full transcript review for context-aware decisions"

  cross_session_portable: true
  ephemeral_references: false
