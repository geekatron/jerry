# EN-005: PR to Main & CI Pipeline Validation

<!--
TEMPLATE: Enabler (DRAFT)
SOURCE: ONTOLOGY-v1.md Section 3.4.9
VERSION: 0.1.0
STATUS: IN_PROGRESS

DESCRIPTION:
  Infrastructure enabler to merge PROJ-006 deliverables to main branch
  and ensure CI pipeline passes all quality gates.

EXTENDS: DeliveryItem -> WorkItem
-->

---

## Frontmatter

```yaml
# === IDENTITY ===
id: "EN-005"
work_type: ENABLER

# === CORE METADATA ===
title: "PR to Main & CI Pipeline Validation"
description: |
  Create PR to merge PROJ-006-worktracker-ontology deliverables to main branch.
  Monitor CI pipeline and resolve any quality gate failures.

  Deliverables to merge:
  - ONTOLOGY-v1.md (canonical work tracker ontology)
  - 7 work item templates (EPIC, FEATURE, STORY, TASK, BUG, SPIKE, ENABLER)
  - 3 critic loop reviews (CL-003, CL-004, CL-005)
  - Final approval report (WI-003)

  CI Pipeline Jobs (all must pass):
  - lint: Ruff linting & format check
  - type-check: Pyright type checking
  - security: pip-audit dependency scan
  - plugin-validation: Plugin manifests & hooks
  - cli-integration: CLI subprocess tests
  - test-pip: Tests with pip (Python 3.11-3.14, 80% coverage)
  - test-uv: Tests with uv (Python 3.11-3.14, 80% coverage)

# === CLASSIFICATION ===
classification: ENABLER

# === LIFECYCLE STATE ===
status: IN_PROGRESS
resolution: null

# === PRIORITY ===
priority: HIGH

# === PEOPLE ===
assignee: "claude-opus-4.5"
created_by: "claude-opus-4.5"

# === TIMESTAMPS ===
created_at: "2026-01-14T16:00:00Z"
updated_at: "2026-01-14T16:00:00Z"

# === HIERARCHY ===
parent_id: "FT-001"

# === TAGS ===
tags:
  - enabler
  - ci-pipeline
  - release
  - quality-gate

# === DELIVERY ITEM PROPERTIES ===
effort: 3
acceptance_criteria: |
  GIVEN the PROJ-006 deliverables are complete
  WHEN a PR is created against main
  THEN all CI pipeline jobs must pass:
    - lint: PASS
    - type-check: PASS
    - security: PASS
    - plugin-validation: PASS
    - cli-integration: PASS
    - test-pip: PASS (Python 3.11-3.14, 80%+ coverage)
    - test-uv: PASS (Python 3.11-3.14, 80%+ coverage)
  AND the PR is approved for merge
due_date: null

# === ENABLER-SPECIFIC PROPERTIES ===
enabler_type: INFRASTRUCTURE
nfrs:
  - "CI pipeline reliability"
  - "Quality gate enforcement"
  - "Branch integration"
technical_debt_category: null
```

---

## State Machine

**Current State:** `IN_PROGRESS`

**Valid States:** `BACKLOG`, `READY`, `IN_PROGRESS`, `BLOCKED`, `IN_REVIEW`, `DONE`, `REMOVED`

---

## Tasks

| Task ID | Description | Status | Evidence |
|---------|-------------|--------|----------|
| T-001 | Stage PROJ-006 artifacts (exclude lock files) | pending | - |
| T-002 | Commit with proper message | pending | - |
| T-003 | Create PR against main | pending | PR URL |
| T-004 | Monitor CI pipeline | pending | CI run URL |
| T-005 | Handle CI failures (if any) | pending | BUG-* files |
| T-006 | Final validation & merge readiness | pending | - |

---

## Relationships

### Parent
- **FT-001**: Domain Discovery Feature

### Related Work Items
- **WI-001**: Parent Ontology Design (deliverable)
- **WI-002**: Markdown Template Generation (deliverable)
- **WI-003**: Design Review & Validation (deliverable)

### Related Reviews
- **CL-003**: Synthesis Review (APPROVED)
- **CL-004**: Ontology Review (APPROVED)
- **CL-005**: Templates Review (APPROVED)

### Artifacts Being Released
- `synthesis/ONTOLOGY-v1.md`
- `templates/EPIC.md`
- `templates/FEATURE.md`
- `templates/STORY.md`
- `templates/TASK.md`
- `templates/BUG.md`
- `templates/SPIKE.md`
- `templates/ENABLER.md`
- `reviews/CL-003-synthesis-review.md`
- `reviews/CL-004-ontology-review.md`
- `reviews/CL-005-templates-review.md`
- `reports/WI-003-final-approval.md`

---

## CI Pipeline Reference

Source: `.github/workflows/ci.yml`

```yaml
# Jobs required to pass:
ci-success:
  needs: [lint, type-check, security, plugin-validation, cli-integration, test-pip, test-uv]
```

### Job Details

| Job | Tool | Config | Threshold |
|-----|------|--------|-----------|
| lint | ruff 0.14.11 | pyproject.toml | - |
| type-check | pyright | src/ | - |
| security | pip-audit | --strict | - |
| plugin-validation | custom | scripts/validate_plugin_manifests.py | - |
| cli-integration | pytest | tests/integration/cli/ | - |
| test-pip | pytest | Python 3.11-3.14 | 80% coverage |
| test-uv | pytest | Python 3.11-3.14 | 80% coverage |

---

## History

| Date | Action | By | Notes |
|------|--------|-----|-------|
| 2026-01-14 | Created | claude-opus-4.5 | EN-005 created for release phase |

---

<!--
DESIGN RATIONALE:
This enabler ensures the PROJ-006 deliverables are properly integrated
into the main branch with full CI validation. The CI pipeline enforces:
- Code quality (lint, format, type-check)
- Security (dependency audit)
- Plugin compatibility (manifests, hooks, CLI)
- Test coverage (80% minimum across Python 3.11-3.14)

All bugs discovered during CI must be logged in work/SE-001/FT-001/
using the BUG.md template.
-->
