# EN-017-002: Platform Portability Test Suite

> **Type:** enabler
> **Enabler Type:** infrastructure
> **Status:** pending
> **Priority:** high
> **Impact:** high
> **Created:** 2026-02-26
> **Due:** --
> **Completed:** --
> **Parent:** EPIC-017-001
> **Owner:** --

---

## Document Sections

| Section | Purpose |
|---------|---------|
| [Summary](#summary) | Brief description and value proposition |
| [Problem Statement](#problem-statement) | What problem this enabler solves |
| [Business Value](#business-value) | Why this enabler matters |
| [Technical Approach](#technical-approach) | How to implement |
| [Acceptance Criteria](#acceptance-criteria) | Definition of done |
| [Related Items](#related-items) | Hierarchy and related items |
| [History](#history) | Status changes |

---

## Summary

Create a dedicated test module (`tests/test_portability.py`) with platform-specific test cases that verify cross-platform behavior of paths, symlinks, shell commands, and line endings. Tests use `pytest.mark.skipif` for platform-conditional execution.

---

## Problem Statement

No existing tests verify cross-platform portability. Bug fixes for PROJ-017 items need regression tests to prevent reintroduction. Without a portability test suite, fixes cannot be verified systematically.

---

## Business Value

- **Regression prevention:** Each bug fix gets a corresponding test
- **Platform coverage:** Tests verify behavior on Windows, macOS, and Linux
- **Documentation:** Tests serve as executable documentation of platform requirements

---

## Technical Approach

1. Create `tests/test_portability.py` with platform-conditional test cases
2. Add `@pytest.mark.portability` marker for selective execution
3. Test categories:
   - Path construction (pathlib usage, no hardcoded separators)
   - Symlink handling (privilege detection, junction fallback)
   - Shell command portability (no bash-only constructs)
   - Line ending normalization (.gitattributes verification)
   - Python interpreter discovery (`sys.executable` vs hardcoded `python3`)
4. Register marker in `pyproject.toml`

---

## Acceptance Criteria

### Definition of Done

- [ ] `tests/test_portability.py` created with platform-specific test cases
- [ ] `@pytest.mark.portability` marker registered in `pyproject.toml`
- [ ] Tests cover all 7 BUG-017 fix areas
- [ ] Tests pass on both Ubuntu and Windows CI runners
- [ ] Tests use `pytest.mark.skipif` for platform-conditional execution

---

## Related Items

### Hierarchy

- **Parent Epic:** [EPIC-017-001: Platform Portability](../EPIC-017-001.md)

### Dependencies

- Depends on: EN-017-001 (Windows CI pipeline must exist to run Windows tests)
- Enables verification of: All BUG-017-* items

---

## History

| Date | Author | Status | Notes |
|------|--------|--------|-------|
| 2026-02-26 | Claude | pending | Enabler created during PROJ-017 restructuring |
