# BUG-017-006: macOS Symlink Resolution Fallback

> **Type:** bug
> **Status:** pending
> **Priority:** high
> **Impact:** medium
> **Severity:** major
> **Created:** 2026-02-26
> **Due:** --
> **Completed:** --
> **Parent:** FEAT-017-001
> **Owner:** --
> **Found In:** v0.21.0
> **Fix Version:** --

---

## Document Sections

| Section | Purpose |
|---------|---------|
| [Summary](#summary) | Brief description and key details |
| [Steps to Reproduce](#steps-to-reproduce) | Steps to reproduce the issue |
| [Environment](#environment) | Environment where bug occurs |
| [Acceptance Criteria](#acceptance-criteria) | Conditions for bug to be fixed |
| [Related Items](#related-items) | Hierarchy and related work items |
| [History](#history) | Status changes |

---

## Summary

The `readlink -f` command used in bootstrap/hook scripts does not work on macOS because macOS ships with BSD `readlink` which does not support the `-f` flag. This causes symlink resolution to fail during context distribution setup.

**Key Details:**
- **Symptom:** Bootstrap or hook scripts fail with `readlink: illegal option -- f` on macOS
- **Frequency:** Every bootstrap invocation on stock macOS (without GNU coreutils)
- **Workaround:** Install GNU coreutils via Homebrew (`brew install coreutils`) and use `greadlink -f`

---

## Steps to Reproduce

### Prerequisites

- macOS without GNU coreutils installed
- Fresh jerry repository clone

### Steps to Reproduce

1. Clone jerry repository on macOS
2. Run bootstrap or context distribution hook that uses `readlink -f`
3. Observe error: `readlink: illegal option -- f`

### Expected Result

Symlinks are resolved correctly using platform-appropriate method.

### Actual Result

Script fails on macOS due to BSD readlink incompatibility.

---

## Environment

| Attribute | Value |
|-----------|-------|
| **Operating System** | macOS 14+ (Sonoma) |
| **Runtime** | BSD userland (no GNU coreutils) |
| **Application Version** | Jerry v0.21.0 |

---

## Acceptance Criteria

### Fix Verification

- [ ] Symlink resolution uses `pathlib.Path.resolve()` in Python or `realpath` (POSIX) instead of `readlink -f`
- [ ] Works on macOS without GNU coreutils installed
- [ ] Works on Linux (where `readlink -f` is standard)
- [ ] No regression on any platform

---

## Related Items

### Hierarchy

- **Parent Feature:** [FEAT-017-001: Shell Command Portability](../FEAT-017-001.md)
- **Parent Epic:** [EPIC-017-001: Platform Portability](../../EPIC-017-001.md)

### Source

- PORT-013 Finding: macOS symlink resolution fallback
- GitHub Issue: [#118](https://github.com/geekatron/jerry/issues/118)

---

## History

| Date | Author | Status | Notes |
|------|--------|--------|-------|
| 2026-02-26 | Claude | pending | Bug created from PORT-001 analysis |
