# Pentest Engagement Template

> **Version:** 1.0.0
> **Skill:** /red-team
> **Agent:** red-lead
> **Configurable Rule Set:** R-011
> **SSOT:** ADR-PROJ010-006 (Authorization & Scope Control), PTES, OSSTMM

## Document Sections

| Section | Purpose |
|---------|---------|
| [Overview](#overview) | Template scope and usage |
| [L0: Engagement Summary](#l0-engagement-summary) | Stakeholder-accessible engagement overview |
| [L1: Scope & Authorization](#l1-scope--authorization) | Detailed scope definition and RoE |
| [L2: Methodology & Planning](#l2-methodology--planning) | Strategic engagement approach |
| [Configuration](#configuration) | Configurable rule set parameters |

---

## Overview

This template guides the creation of penetration testing engagement scope documents per ADR-PROJ010-006's three-layer authorization architecture. Every /red-team engagement MUST start with this template completed by red-lead.

**When to use:** At engagement initiation, before any operational agent is invoked.

**Agent:** red-lead (mandatory first agent for all engagements).

**Criticality:** Scope documents are always C4 (irreversible authorization decision).

---

## L0: Engagement Summary

| Field | Value |
|-------|-------|
| **Engagement ID** | RED-{NNNN} |
| **Client/Target Organization** | {organization name} |
| **Engagement Type** | {External Pentest / Internal Pentest / Web App / API / Red Team / Social Engineering / Physical} |
| **Start Date** | {YYYY-MM-DD} |
| **End Date** | {YYYY-MM-DD} |
| **Engagement Lead** | {red-lead engagement ID} |
| **Authorization Status** | {Authorized / Pending / Expired} |

### Engagement Objectives

| # | Objective | Priority | Success Criteria |
|---|-----------|----------|-----------------|
| 1 | {objective} | {Critical / High / Medium} | {measurable criteria} |

### Executive Risk Summary

{2-3 paragraph summary for stakeholders: what will be tested, why, and what are the key risks.}

---

## L1: Scope & Authorization

### Target Definition

| Target Type | Target | In Scope | Notes |
|-------------|--------|----------|-------|
| Network | {IP range/CIDR} | Yes/No | {notes} |
| Domain | {domain name} | Yes/No | |
| Application | {app URL} | Yes/No | |
| System | {system name} | Yes/No | |

### Exclusion List

| Excluded Target | Reason | Consequence of Violation |
|----------------|--------|------------------------|
| {target} | {reason} | {consequence} |

### Rules of Engagement

| Rule | Setting | Notes |
|------|---------|-------|
| Social Engineering Authorized | {Yes / No} | {constraints} |
| Persistence Authorized | {Yes / No} | {constraints} |
| Exfiltration Authorized | {Yes / No} | {data types permitted} |
| DoS Testing Authorized | {Yes / No} | {constraints} |
| Physical Access Testing | {Yes / No} | {constraints} |
| Testing Hours | {24/7 / Business Hours / Custom} | {schedule} |
| Emergency Stop Contact | {name, phone, email} | |
| Escalation Contact | {name, phone, email} | |
| Communication Channel | {encrypted channel details} | |

### Technique Allowlist

| ATT&CK Tactic | Authorized Techniques | Agent |
|---------------|----------------------|-------|
| TA0043 Reconnaissance | {T-IDs or "All"} | red-recon |
| TA0042 Resource Development | {T-IDs} | red-infra |
| TA0001 Initial Access | {T-IDs} | red-exploit, red-social |
| TA0002 Execution | {T-IDs} | red-exploit |
| TA0003 Persistence | {T-IDs or "Not Authorized"} | red-persist |
| TA0004 Privilege Escalation | {T-IDs} | red-privesc |
| TA0005 Defense Evasion | {T-IDs} | distributed |
| TA0006 Credential Access | {T-IDs} | red-privesc |
| TA0007 Discovery | {T-IDs} | red-lateral |
| TA0008 Lateral Movement | {T-IDs} | red-lateral |
| TA0009 Collection | {T-IDs or "Not Authorized"} | red-exfil |
| TA0010 Exfiltration | {T-IDs or "Not Authorized"} | red-exfil |
| TA0011 Command & Control | {T-IDs} | red-infra |
| TA0040 Impact | {T-IDs or "Not Authorized"} | red-exploit |

### Agent Authorizations

| Agent | Authorized | RoE-Gated | Special Conditions |
|-------|-----------|-----------|-------------------|
| red-lead | Yes (always) | No | Scope authority |
| red-recon | {Yes / No} | No | |
| red-vuln | {Yes / No} | No | |
| red-exploit | {Yes / No} | No | |
| red-privesc | {Yes / No} | No | |
| red-lateral | {Yes / No} | No | |
| red-persist | {Yes / No} | Yes | Requires `persistence_authorized: true` |
| red-exfil | {Yes / No} | Yes | Requires `exfiltration_authorized: true` |
| red-reporter | Yes (always) | No | Report generation |
| red-infra | {Yes / No} | No | |
| red-social | {Yes / No} | Yes | Requires `social_engineering_authorized: true` |

### Scope Document YAML

```yaml
scope:
  engagement_id: "RED-{NNNN}"
  version: "1.0"
  authorized_targets:
    - type: "{network/domain/application}"
      value: "{target}"
  technique_allowlist:
    - "{T-ID}"
  time_window:
    start: "{ISO-8601}"
    end: "{ISO-8601}"
  exclusion_list:
    - "{excluded target}"
  rules_of_engagement:
    escalation_contact: "{contact}"
    emergency_stop: "{contact}"
    communication_channel: "{channel}"
    social_engineering_authorized: {true/false}
    persistence_authorized: {true/false}
    exfiltration_authorized: {true/false}
    data_types_permitted:
      - "{data type}"
  agent_authorizations:
    - {agent-name}
  evidence_handling:
    storage: "skills/red-team/output/RED-{NNNN}/evidence/"
    retention_days: {days}
    destruction_method: "secure-delete"
  signature:
    authorized_by: "{authorizer}"
    date: "{YYYY-MM-DD}"
    confirmation: "I authorize this engagement within the defined scope"
```

---

## L2: Methodology & Planning

### Engagement Approach

| Phase | PTES Phase | Planned Activities | Duration |
|-------|-----------|-------------------|----------|
| 1 | Pre-engagement Interactions | Scope definition, RoE | {days} |
| 2 | Intelligence Gathering | Passive + active recon | {days} |
| 3 | Threat Modeling | Target prioritization | {days} |
| 4 | Vulnerability Analysis | Scanning + manual analysis | {days} |
| 5 | Exploitation | Initial access attempts | {days} |
| 6 | Post-Exploitation | Privesc, lateral, persistence | {days} |
| 7 | Reporting | Findings documentation | {days} |

### Risk Assessment

| Risk | Likelihood | Impact | Mitigation |
|------|-----------|--------|------------|
| Service disruption during testing | {H/M/L} | {H/M/L} | {mitigation} |
| Data exposure during exfiltration testing | {H/M/L} | {H/M/L} | {mitigation} |
| Detection by security monitoring | {H/M/L} | {H/M/L} | {mitigation} |
| Scope creep into excluded systems | {H/M/L} | {H/M/L} | Circuit breaker checks |

### Evidence Handling Plan

| Evidence Type | Storage Location | Retention | Destruction Method |
|--------------|-----------------|-----------|-------------------|
| Scan results | `output/RED-{NNNN}/evidence/scans/` | {days} | secure-delete |
| Screenshots | `output/RED-{NNNN}/evidence/screenshots/` | {days} | secure-delete |
| Tool output | `output/RED-{NNNN}/evidence/tools/` | {days} | secure-delete |
| Credentials found | `output/RED-{NNNN}/evidence/credentials/` | {days} | immediate secure-delete after report |

---

## Configuration

### Configurable Rule Set (R-011)

| Parameter | Default | Override | Description |
|-----------|---------|----------|-------------|
| `methodology` | PTES | OSSTMM, NIST-800-115, custom | Primary methodology framework |
| `scope_validation_frequency` | every-agent-transition | per-action, per-session | How often scope is revalidated |
| `evidence_retention_days` | 90 | 30, 60, 90, 180 | Default evidence retention |
| `auto_generate_yaml` | true | false | Auto-generate scope YAML from template fields |
| `circuit_breaker_strictness` | standard | relaxed, standard, strict | Scope validation strictness |

---

*Template Version: 1.0.0 | /red-team Skill | PROJ-010 Cyber Ops*
